---
layout: post
title: 'Simple Noise Reduction with Loopy Belief Propagation'
subtitle: Practical Example
thumbnail-img: /assets/img/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_files/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_23_0.png
date: '2022-09-24 00:00:00 +0200'
excerpt_separator: <!--more-->
categories: graph
comments: false
mathjax: true
author: Mario LÃ¼der
---

I want to continue my previous [post](https://mayio.github.io/2022-09-17-Loopy-Belief-Propagation) with a (useful) example to get more a feel how to use Loopy Belief Propagation in practice. 

The aim is to remove noise from an image - which is only a toy example.

<!--more-->

Please see the [References](#references). I have taken the ideas from there. My contribution is only to give an example of their work coded in python for learning purposes.

## Graph

The graph is initialy defined as Markov Random Field (MRF). Like the one below.

![image.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqsAAAGKCAYAAAArAwj/AAAABHNCSVQICAgIfAhkiAAAIABJREFUeF7tnQ2YXVdd7meaMZNJMk2aacAO0lJUFCZJFUwA5SLFq4iXTv1KWuFqopKiDSofUhBFBb20SFqQj6uQFooXsG1GpVFERLgT5CJKigQMiliTFmilyZR8zDSZPsnMfd925un0ZM45e5+zP9ba+7ef533SOXvttf7r999vzzr7Y62eHjYIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAgQwI9GZQB1VAoGgCw2pwgzQoLZUelE5I+6V7iw6G9iBQAwJ4rgZJpovBEcB3cylhsBrcuUlAixAY0mfbpFHpEqlfmpZ8/lqzc5r/3IPWPdLN0oTEBgEIpCOA59LxojQEsiCA77KgSB0QKJjAJrV3q3RSmpLmB6VJ/nV5H+fjXQ8bBCDQngCea8+IEhDImgC+y5oo9UGgAAJr1MaY5AHnGSnJ4LRZGR/velyf62WDAATOJoDnzmbCJxDImwC+y5sw9UMgJwK+1X+/dEpqNgDt5HPX53ovyyluqoVArATwXKyZI+6YCeC7mLNH7LUl4GdPd0ppb/enHbi6frfD89q1PdXo+BwBPMepAIHiCeC74pnTIgQyIWDz7pImpbSDz07Kux23x4A1k/RRSYQE8FyESSPk6Angu+hTSAfqTOB6db6oger84Nbt+QorGwTqSADP1THr9LlsAviu7AzQPgQ6JODndvK+9d/s6qvb5RnWDhPHYdESwHPRpo7AIyaA7yJOHqHXm4DfhPRLT80Gk0V87vaZJaDe52Gdeo/n6pRt+hoKAXwXSiaIAwIdEPB0Ulm/9Z92gOv2d3cQO4dAIEYCeC7GrBFz7ATwXewZJP7aEvAkyGXd/m8c0DqOjbXNBB2vCwE8V5dM08+QCOC7kLJBLBBIScArS3U74X/joLPTv08rlltSxk9xCMRGAM/FljHirQIBfFeFLNKHWhLw+sdeCrXTwWUexzkex8UGgSoSwHNVzCp9Cp0AvssoQ+dkVA/VQCANgW0qPJPmgALKOp6tBbRDExAog8A2NYrnyiBPm3UmgO/qnH36Hj2BvepBHldHu61zPHqydAACixPAc4tz4VMI5EkA32VElxV8MgJJNakIHFXpVamOKKaw4zqvmKZoBQKFEsBzheKmMQg8RADfZXQi8BhARiCpJjGBYZXsT1y62IIDau6CYpukNQjkTgDP5Y6YBiBwFgF8dxaSzj9gsNo5O47sjMAGHTbd2aG5H+U5Vx0fGwSqRADPVSmb9CUWAvguw0wxWM0QJlUlIjCoUqE+fuK4HB8bBKpEAM9VKZv0JRYC+C7DTDFYzRAmVSUisFSlQh6shvqIQiK4FILAIgTw3CJQ+AgCORPAdxkCZrCaIUyqSkTgQZXyW/shbo4r1EcUQuRFTHEQwHNx5Ikoq0UA32WYTwarGcKkqkQETqhUyINVx8cGgSoRwHNVyiZ9iYUAvoslU8QJgUUI+A3J0Favmp+f1S9YMRvAIknjo6gJ4Lmo00fwkRLAdxkmLtRnBzPsIlUFSIC55wJMCiFVmgCeq3R66VygBPBdRonhMYCMQFJNKgL7U5UurnCocRVHgJaqSiDUczvUuKp6HtCvYgmEen6HGlfT7DBYbYqGHTkS2KO6H8ix/k6qdjyOiw0CVSSA56qYVfoUOgF8F3qGiA8CLQgMaV9oz606HsfFBoEqEsBzVcwqfQqdAL7LKENcWc0IJNWkIjCh0v7FOZPqqPwKn1HVt0uOiw0CVSSA56qYVfoUOgF8l1GGGKxmBJJqUhHwi31+ZiaUF/w8t+r1qXpAYQjER2BMIYcybRyei+/8IeL0BFbqEE9hFcpYC9+lzyFH1JTAJvX7/0mfk8YlTxc1P3VUGf+6/d01zQXdrgcB34p8m3RY+ryE5+qRd3pZHgEPTrdKX5M+IH0Y35WXDFqGQBoC36bC/0f6urRNspnXSPdLZQxS59t0++dJbBCoGoFvUYd+TbpPeod0voTnqpZl+hMagWcpoH3SZ6RnzAWH70LLEvFAoIHACv39u9IR6fcl3xZZuI3qjympjAGr272sIR7+hEDsBPx4zQukL0sfkZ7S0CE8F3uGiT9EAhcrKN+lu1t6odT4mBu+CzFrxFR7Ar5y+rPSV6UPShe2ILJT+yalIgesbs/tskGgSgTWqzMfk74kPb9Fx/BcCzjsgkAKAueq7HWSX6b6LWl5i2PxXQs47IJA0QR+QA3+k+TbIM9M0Lh/ge6Sihqwuh231/jLN0GoFIFAkAQeo6j+WPqG9FLJjwC02vBcKzrsg0B7AktUZLt0r/ReycurttvwXTtC7IdAAQSeoDZulXwb5EVSmjcgbWL/6sz7kQDX73YYqAoCW/QE+tWDV0l+eeoGKc3z13gu+vTTgZIIPFftekabT0pPSxkDvksJjOIQyIrAoCp6o+TbIL8ttboN0q5NP9fjl56yfmPZ9blenlFtlwH2x0DAX3g/Kd0pec7iJ3URNJ7rAh6H1orAd6q3H5L+U/ppqZuLHviuVqcOnS2TgG+D/KJ0j/Q+6XEZBeM3J8ckXwU9LXXzLKuPdz1+8N31skEgdgLfqw6MS1+QfiijzuC5jEBSTSUJrFavPBf3EenV0rKMeonvMgJJNRBoRuA52vHP0qekjc0Kdfm5671F8lKoaR8PcHkf5+Pziq/L7nE4BFIRuECl3yP5GbmrJP9YzHrDc1kTpb6YCfQp+KslPwv+bumxOXUG3+UElmrrS+Db1fU/lw5KW6RuboMkpehJzV8hjUvflHxL/6h0TDo+96//9ufePy65vI9jg0DsBAbUgddKvqrzJmlVAR3CcwVApomgCTxP0R2QPi5dUlCk+K4J6CIGGk2a5uPICPgL0tNy/LzkF5TeKnlwWMbmK0wbJD8r6xdMvIScl7TzbVFfdWKDQBUI+P/PV0ieFmefdI3kZ+XK2PBcGdRpswwCT1ajvuX/HdKvS38p+VG0MjZ8VwZ12oySgG+D/JL0X5Kne/rWKHtB0BCIi8DCZYmfHVfoRAuBKAn4qubbJc+s8XJpaZS9IGgI1JDAj6jP/yL9X+l7ath/ugyBogkstixx0THQHgTqRMCD0pdJC5clrlP/6SsEoiXw3Yr8r6SvSD8u8bhItKkk8EgIzC9L7Onffk9aGUnchAmBWAn4e81TGTZbljjWfhE3BCpPwNNo/KHk2yCvlPw8KBsEIJAfgTTLEucXBTVDoF4E1qu7SZYlrhcVeguBwAl4acZflXwb5H9LawOPl/AgUAUCXpb4s1LSZYmr0Gf6AIEyCaRdlrjMWGkbAhCYI+DbIP9D+jfpo9I6yEAAArkTeIJa6HRZ4tyDowEIVJDA/LLEnv7tBinNssQVxEGXIBAPAQ9M/1byQPXHJJ5LjSd3RBonAU+19kbJX5jdLkscJwGihkCxBPy99lNSFssSFxs5rUGg5gR8i/+PJN/y/xXJjwCwQQAC+RHIa1ni/CKmZgjET+Cp6sJeyfNvZ7UscfxU6AEEAifg2yCe4NgvT3lCf79MxQYBCORL4DmqPu9lifPtAbVDIC4CRSxLHBcRooVABAR8G+QnpP+QvBLHd0UQMyFCIHYCXv3mLyQvS7xZ4jGb2DNK/KET8LLEvyl5+reiliUOnQnxQSAKAp7I3xP6f1H64SgiJkgIxE3AyxK/WfJzqa+RlsXdHaKHQPAE/EPwSukuaUx6YvAREyAEIPAQAS+JeqPkJVK9VKqXTGWDAATyI2CP/bLEssT5MaZmCDQSeLo++LT0OYlliRvp8DcEAiXgqzi/Ifmqzh9IvsrDBgEI5EtgflniT6gZliXOlzW1Q8AEHi+9X/q6tE3y4hpsEIBA4AR8G+QK6ZD055Kfl2ODAATyJbBwWeLL1RTPpebLm9oh4GWJXy+xLDHnAgQiI7BR8X5K8hvHz4ksdsKFQIwEWJY4xqwRc8wEfOX056SvSh+ULoy5M8QOgToR+DZ19k+ke6RfkDyXIxsEIJAfgYXLEr9TzbAscX6sqRkC8wRYlphzAQIREliumH9H8m2Q/yV5VRw2CEAgPwK+vb9wWeKR/JqiZghAYI7AE/QvyxJzOkAgMgK+DfI/Jd8GuUV6QmTxEy4EYiQwvyzxvyp4liWOMYPEHBuB+WWJfUHmdZIv0LBBAAIREPh+xfhPc/ItETYIQCBfAixLnC9faodAIwE/yvZiyY+23Sw9rrEAf0MAAmESuEhh+Sqqr6b6qirTc4SZJ6KqDgGWJa5OLulJPAQuVaifl/5e+r54wiZSCNSbgG+D+HlU3wb5XcnTdbBBAAL5EfBzqSxLnB9faobAYgRYlngxKnwGgcAJ+DaI3+z3RMd+099v/LNBAAL5EvheVc+yxPkypnYILCSwWn/slFiWmPMiEYE6L8M5LEIbJF/FXCo9KJ2Q9kv3JqKXbaEfVHVvkU5KvsLjZ1TZIFA1AiH5zssS+w6G3/T3DBs3SaerBpz+1J5ASJ7zmGO79LvSHskvMHqJYjYItCRQp8HqUF9f37bVq1ePnjx58pLe3t7+kZGR6aGhod7+/v7e6enp2YmJidkDBw70z87OTg8MDOw/evTontOnT98sgr4dn9f27arYS6M+TXq1dJs0m1dj1AuBggmE6LsBMXi59ArpPdJ3SccK5kJzEMiLQIiec1+9LPEN0n3S8yQ/o8oGAQjMEdi0atWqW5ctW3byyiuvnBobG5s9dOjQ7MzMjMakZ2/+3Ptd7oorrpjycT5edW3KmOgq1edBqm+DvFbyFygbBKpCIETfLVyW+M8E2j8U2SBQFQIhes5svSzxh6WvSCxLXJWzjX5kRmDN4ODg2Nq1a6euu+66M4cPHz57ZJrgEx/n412P61N0Xmqxm81Xs39J8q0P33a8oJvKOBYCgREI1XfzyxJ/TryeExgzwoFANwRC9dyQOvU26bD0SskzbbBBAAILCIyuWLHi/h07dpyanJxMMCRtX8T1uD7Xq3Yu65D2D+u4L0rjkl/qYINAlQiE6DuWJa7SGUZfGgmE6DkvS/xrkm/3syxxY8b4GwIi0KvB5M7h4eGpvXv3th+BdlDC9bp+t+P2ElL3M3F/Kd0p+eWppMclrJ5iECiVQIi+83RvLEtc6mlB4zkSCNFz/l57gfRv0kclliXO8QSg6ngJ9Oo2/a7169dPHjlypINhaPJD/GjAunXrJt2ecLUaePqRgbdKfi711yVug8R7fhH54gRC813jssReWIMNAlUiEJrnzNZv9f+txLLEVTrT6Ev2BDRwvN4D1WPHjiUfdXZR0u14wDp3hbWxQ74N8iuSb4P8kfSYxgL8DYEqEAjMd/PLEv+j2Pq/2SBQOQKBeY5liSt3htGhPAmM+tZ83ldUG8e2vsLqdtWx+WdYfZX1xyT/uvyYtD7PTlM3BEomEIrvWJa45BOB5gsjEIrnfJfwVZLvGvruYbcvHhcGkIYgUBaBNX7pKa9nVBsHqI1/j4+Pz869dPVMAfBzOl+W/NxOq8cDymJFuxDIikAIvvumOnO95HmQ/XwqyxJnlV3qCZFACJ7zC8Y/K/n9C7+H4fcx2CAAgXYEPJ2U39JvHEQW+fdVV111WosInFKsfgPSjwCwQaDSBELw3fbt22eXL19+SKBZlrjSZxudM4EQPPeSl7zkjDx3VOF4Zhs2CEAgIYFNnv80q+mpOh3guv3zzz//AcXsuRzZIFB1AsH4zv7Hd1U/3eifCATjOX3X4TlOycIJLCm8xQwb1MpSN1xzzTUbLr300lJvuS9durRHK1+ds2/fvtVattULB7BBoLIEQvLdmTNn8F1lzzQ6Nk8gJM/xXcd5CYF0BIa8FGqnK1N1ehW12XGOw/GoC161gw0CVSWA76qaWfoVKgE8F2pmiKswAp6TMMqtr69v2+WXXz6jWxJBxO84RkdHZxTX1iACIggI5EAA3+UAlSoh0IIAnmsBh121IRDtYHX16tWjmzdvXh5SprZs2bJct2tGQ4qJWCCQJQF8lyVN6oJAewJ4rj0jSkAgWAKaLurooUOHmt2VL+XzgwcPzq5cudLT6bBBoJIE8F0l00qnAiaA5wJODqEVRiDWK6vDvb29/RdeeGFhoJI0dNFFF/VolDygshckKU8ZCERGAN9FljDCjZ4Anos+hXQgCwKxDlY3jIyMTGvAmgWDzOpwPIrL861uyKxSKoJAOATwXTi5IJJ6EMBz9cgzvWxDINbB6uDQ0FBYI9U50HNxDbbhzm4IxEgA38WYNWKOmQCeizl7xJ4Zgb7Maiq2oqX9/f1BDlaXLFlyrlDsLhYHrUGgGAI6v4tpKGUr+C4lMIpHQyBUz819B/dHA5JAoyYQ65XVBzX5/myI5DVJ+XHFtVnyYBrBoErnwJa58zs46+E7/l9T0f/fBuu5ue/g6eD+Z0BAlSQQ62D1xMTERJCD1bm4TlTybKFTdSeA7+p+BtD/ognguaKJ016QBIK8lZ6A1LCmiLrz+PHjy0J6yUozAfQMDg5OT01NXaw+3JugHxSBQEwE8F1M2SLWKhDAc1XIIn3omkCsV1bv0cBw+u677+4aQJYV3HXXXT0aPHvJVQaqWYKlrlAI4LtQMkEcdSGA5+qSafrZkkCsg9WegYGB/fv27WvZuaJ33nHHHT166Hx/0e3SHgSKIoDviiJNOxB4mACe40yAQE9PtIPVo0eP7tm9e/cDISXxtttue+DYsWN7QoqJWCCQJQF8lyVN6oJAewJ4rj0jSkAgZAJDy5YtO3n48OFSllZtbNRxOB4BGwoZGrFBoEsC+K5LgBwOgZQE8FxKYBSvHoFor6wqFRO65b7npptumgkhLTfeeOMZxXO74wohHmKAQE4E8F1OYKkWAk0I4LkmYPgYArEQ2LR27dqpycnJxgudhf7t9h2HoG2MBRxxQqALAviuC3gcCoEOCOC5DqBxCASCIaCposZ27NhxqtDRaUNjV1999SnFwapVwZwVBJI3AXyXN2Hqh8CjCeA5zggIxE1gzYoVK+7fu3dvKePV8fHxWbcvhOfFjZHoIZCKAL5LhYvCEOiaAJ7rGiEVQKBcAqPDw8NTR44cKXTA6peq3K66flm53ad1CJRCAN+Vgp1Ga0wAz9U4+XS9AgR0dXPnunXrJjV1VCEDVrfj9txuBfDRBQh0RADfdYSNgyDQMQE81zE6DoRAEAR69UzPLg8g857OyvW7HS35uks9j3XJ2iCSRhDRE8B30aeQDkRGAM9FljDChUAjgV7/6vSt+byeYfUzqq5/7ooqA9XGDPB3HQnguzpmnT6XSQDPlUmftiGQEYFRv/Tkt/SzmtbK9bi+uZepeEY1o0RRTaUI4LtKpZPOREAAz0WQJEKEQCsCazzVh+c/vfbaa093+mjAfffdN+vjXc/c9FRrWjXKPgjUnAC+q/kJQPcLJ4DnCkdOgxDInsDGVatW3eKlULds2TI1NjY2e/DgwdmZmZlFX8Ty597vci7v43y8wmLC/+xzQ43VJYDvqptbehYmATwXZl6IKgMCdXrmcqivr2+rBp6j09PTl2ikOjAyMnJqaGiod8mSJeeeOXPm+MTExOyBAweW9fb2ntTSqfv1xv+e06dPv0+cWUI1g5ONKmpJAN/VMu10ukQCeK5E+DSdD4E6DVYbCV6gDzZIg5JXn9osnZC+IN3bWJi/IQCBTAjgu0wwUgkEEhPAc4lRURACYROYDTs8ooNAJQngu0qmlU4FTADPBZwcQmtO4Jzmu9gDAQhAAAIQgAAEIACBcgkwWC2XP61DAAIQgAAEIAABCLQgwGC1BRx2QQACEIAABCAAAQiUS4DBarn8aR0CEIAABCAAAQhAoAUBBqst4LALAhCAAAQgAAEIQKBcAgxWy+VP6xCAAAQgAAEIQAACLQgwWG0Bh10QgAAEIAABCEAAAuUSYLBaLn9ahwAEIAABCEAAAhBoQYDBags47IIABCAAAQhAAAIQKJcAg9Vy+dM6BCAAAQhAAAIQgEALAgxWW8BhFwQgAAEIQAACEIBAuQQYrJbLn9YhAAEIQAACEIAABFoQYLDaAg67IAABCEAAAhCAAATKJcBgtVz+tA4BCEAAAhCAAAQg0IIAg9UWcNgFAQhAAAIQgAAEIFAuAQar5fKndQhAAAIQgAAEIACBFgQYrLaAwy4IQAACEIAABCAAgXIJMFgtlz+tQwACEIAABCAAAQi0IMBgtQUcdkEAAhCAAAQgAAEIlEuAwWq5/GkdAhCAAAQgAAEIQKAFAQarLeCwCwIQgAAEIAABCECgXAJ95TZP6xDoiMCwjtogDUpLpQelE9J+6d6OauQgCECgFQE814oO+yCQDwF8N8eVwWo+Jxi1ZktgSNVtk0alS6R+aVrqndOs/rXmP/egdY90szQhsUEAAukI4Ll0vCgNgSwI4LssKFa4Dg902MIjsEkh3SqdlKak+UFpkn9d3sf5eNfDFh4BfBdeTvBceDnJMiI8lyXN7OrCd9mxrHRNGDis9K5ROGOSB5xnpCSD02ZlfLzrcX2uly0cAvgunFzguXBykWckeC5PuunrxnfpmdX6CAwcTvp9q/9+6ZTUbADayeeuz/VeFk5Xax8JvgvjFMBzYeShiCjwXBGUk7WB75JxotQCAhi4/NPBz5/ulNLe7k87cHX9bsftsZVLAN+Vyx/Plcu/jNbxXBnUH90mvis/B9FGgIHLTZ3Nu0ualNIOPjsp73bcHgPWcvOO78rjj+fKY19my3iuTPoPf+fwXVduDqJuHQOXm77r1XxRA9X5wa3b8xVWtvII4Lvy2OO58tiX2TKeK5N+Tw++K5d/9K1j4PJS6Od28r713+zqq9vlGdbyco/vymGP58rhHkKreK68LOC78thXpmUMXE4q/SakX3pqNpgs4nO3zywB5eQf3xXPHc8VzzykFvFcOdnAd+Vwr1yrGLiclHo6qazf+k87wHX7u8vpfu1bxXfFnwJ4rnjmIbWI58rJBr4rh3vlWsXAxafUkyCXdfu/cUDrODYWj6D2LeK7Yk8BPFcs7xBbw3PFZwXfFc+8si1i4OJT65Wlup3wv3HQ2enfpxXLLcUjqH2L+K7YUwDPFcs7xNbwXPFZwXfFM69sixi42NR6/WMvhdrp4DKP4xyP42IrjgC+K441niuOdcgt4blis4PvMuJ9Tkb1UA0E0hDYpsIzaQ4ooKzj2VpAOzQBgTIIbFOjeK4M8rRZZwL4rs7Zz6Hv/NrMAWqLKvdqXx5XR7utc7xFzOzKngC+y55psxrxXDMy9foczxWbb3yXEW9W8HkYpA0Mi4xOqgTVHFWZVQnKFV3EcZ1XdKM1bg/fFZd8PFcc65BbwnPFZgffZcSbxwAyAkk1iQkMq2R/4tLFFhxQcxcU2yStQSB3Angud8Q0AIGzCOC7s5B0/gGD1c7ZcWRnBDbosOnODs39KM+56vjYIFAlAniuStmkL7EQwHcZZorBaoYwqSoRgUGVCvWRC8fl+NggUCUCeK5K2aQvsRDAdxlmisFqhjCpKhGBpSoV8mA11EcUEsGlEAQWIYDnFoHCRxDImQC+yxAwg9UMYVJVIgIPqlSob6Q6rlAfUUgEl0IQWIQAnlsECh9BIGcC+C5DwAxWM4RJVYkInFCpkAerjo8NAlUigOeqlE36EgsBfBdLpiKKM9TBU0QIE4fqNyRDW73K+bf8ghWzASROZdcF8V3XCBNVgOcSYapFITxXXJrxXYasQ312MMMuJqrKBoZFIlSZFGLuuUwwRl8JvisuhXiuONYht4Tnis0OvsuIN48BZASSalIR2J+qdHGFQ42rOAK0VFUCoZ7bocZV1fOAfhVLINTzO9S4mmaHwWpTNOzIkcAe1f1AjvV3UrXjcVxsEKgiATxXxazSp9AJ4LvQMxRZfDzHU2zChtRcaM+tOh7HxVYcAXxXHGs8VxzrkFvCc8VmB99lxJsrqxmBpJpUBCZU2r84Z1IdlV/hM6r6dslxsUGgigTwXBWzSp9CJ4DvMsoQg9WMQFJNKgKrVfq0FMr557lVr0/VAwpDIC4CfoH0i1IoL5LiubjOH6LtjMCIDrsQ33UGb+FRoQwWuu8JNcRAoE9BXi19WZqS/koqexJ+t//X0mdjAEiMEOiAwDN0zKeln5A+KeG5DiByCARSEDhfZd8pjUu3Sn8h4bsUACm6OAGe41mcS5afPk+VHZA+Ll0yV/Ea/Xu/ZP5lye2fNxcP/xRLAN/ly/vxqv4D0telrZIvTuC5fJmHXjueyzdDXmL1FdJh6e3S/HsQ+C5f7rWpHQPnl+onq2pfufyKNCo13ob0Z77KWsZg1e1ell/XqbkNAXzXBlCHu1fquDdIfl7O//rvhRueawBSoz/xXD7J9vfa5ZK/5/x95++9xg3fNRLh79QEMHBqZG0P8C9K/7L0L8yXS/7F2WzbqR2TUpEDVrfndtnKI4DvsmXvK6dbpa9JvqLqZ+WabXiuGZlqf47nss+v7xT6jqHvHP5om+rxXRtA7G5NAAO35pNmrwelL5Puk94h+dmddpt/le6Sihqwuh2313iVt12c7M+WAL7LjuezVNU+6TOSn1Ftt+G5doSquR/PZZfXx6qqd0vfkPwuht/JaLfhu3aE2N+SAAZuiSfRTpvQt9T98tRHpKckOuqRQj7evzrzfiTA9bsdBqopE5RDcXzXPdSLVcVu6W7phSnPazzXPf+NK4frAAAgAElEQVTYasBz3Wdsmap4tXRE8iwyad95wHfd56C2NWDg7lK/Xod/TPqS9PzuqnrouVa/9HRKcl6ykutzvTyj2mWCMjwc33UO81wdep3k51J/S1reeVV4rgt2sR2K5zrPmAeZPy39p/Qh6Ts7r+qhI/mu6xJgHQ/HwJ1l/TE67I8l3wZ5qfQtnVVz1lF+c3JM8lVQz8fazYDVx7seX31yvWzhEMB36XOxRIdsl+6V3isNp69i0SPw3KJYKvchnusspU/TYZ72bb/03M6qWPQofLcoFj5sRgADNyOz+Of9+vhVkm+D3CClvQ2yeK1nf7pRH90ieSnUtI8HuLyP8/Guhy08AvguXU78JekvS39p+sszjw3P5UE1nDrxXLpc+MfgzZJ/HL5Y8o/FPDZ8lwfVCtaJgZMl1bdBfkq6U9ojPSnZYV2X8swCnrtuXPqm5Fv6R6Vj0vG5f/23P/f+ccnl5+e403+yBUgA3yVLim83+rajbz/6NmQRz1vjuWS5ia0UnkuWMT9W8zrJj9n4cRs/dlPEhu+aUC7if3pNmg7qYxsYFq1T8lTtfovkq6ieispTdZS1XaCGN0iDkq/yemWQE9IXJP8CZouDAL5rnScvS+wvzK3Sm6U/lPyDrIwNz5VBPfs28Vxrph4H/Ix0rfSPkl+kOtj6kFz34rtc8cZXOb82m+fMZnmP5EHgVVJet0GaR8CeqhLAd4tndn5ZYj8L7qlxPEUOGwSyIIDnmlP0lG//IHkKuP/WvBh7IFAeAQx8NvsBffSbkm+DvEladXYRPoFAVwTw3dn4nqePDkgLlyU+uxSfQKAzAnjubG5ePMOLaHgxja2SF9dgg0CQBDDwI2nxbZArpbskv5H/xCAzRlBVIIDvHsmil2f0Mo3/LnlKGx5LqsIZHl4f8NwjOVmp/3yD5Asy/td/s0EgaAIY+OH0PF3/fFr6nPTsoDNGcFUggO8efgnw7UpmkmWJq5Bz+lAuATz38JXTbUpDkmWJy80WrUOggUDdDfx48Xi/9HVpm8RtECxSBIE6+66TZYmLyAltVJtAnT3nzPpZVD+T6mdT/YwqGwSiIlBXA69Qll4v+TbI70ncBonqtI0+2Dr6zrf3vYqab/d3sixx9EmnA6USqKPnDPxiaX5ZYr/tz2M2pZ6GNN4pgboZ2FdOf076qvRByQ+Ys0GgaAJ1852nW/s7KYtliYvOFe1Vg0DdPJflssTVOAPoRdQE6mTgH1CmPit9Rnpm1Fkj+NgJ1MV3Xpb4XZKnotohZbUscez5J/7iCdTFc3ktS1x8xmgRAgsI1MHAT1B/b5Xull4k8VwqFiibQNV95wUrrpHyXpa47DzSfjwEqu45Z+K5Ut7LEseTcSKtFIEqG9irPL1R8nOpvy15GTk2CIRAoKq+8/Nw88sS367/LmpZ4hBySgxhE6iq50x94bLE9h/PpYZ9LhJdBwSqaGDfBvlF6R7pfdLjOuDCIRDIk0AVfedlifdKXvr3h/KER90Q6IBAFT3nJcBvkHwHw3cylnXAhUMgEAWBqhn4UlH/Z+lT0sYoMkCQdSRQJd+xLHEdz+D4+lwlzy1cltjPhLMscXznIxGnJFAVA3+H+v0X0kFps8RtkJQnAsULJVAF380vS+yrOixLXOjpQ2MdEKiC59ztH5W8LLFn1/AsG2wQqAWB2A28WlnaKfkL8zUSt0FqcdpG38mYfecfgvPLEnv+RpYljv50rEUHYvacE8SyxLU4TelkMwKxGti3QX5Z+i9pl/StzTrI5xAIkECsvptflvgOMWVZ4gBPLEJqSiBWzw2pRyxL3DSt7KgLgRgN/CNKzr9In5C+py6Jop+VIhCb71iWuFKnXy07E5vn5pclPqxsvUM6v5ZZo9MQmCMQk4G/WzH/lfQV6XKJ51I5jWMlEIvvWJY41jOMuBsJxOI5f6+xLHFj9vi79gRiMLBvg7xN8i/MV0qecJwNAjETCN13LEsc89lF7IsRCN1zjplliRfLHJ9BQARCNrCXZvxV6T7pndJaMgaBihAI2XcsS1yRk4xuPIpAyJ5jWWJOVgi0IRCigX0b5AXSv0kflUba9IHdEIiNQIi+e4Igzi9L/EL9N8sSx3ZWEW8rAiF6jmWJW2WMfRBYQCA0A69TbH8r/av0YxLPpXK6VpFASL5buCzx6wSbZYmreMbRp5A85+81liXmnIRACgKhGNi3+P9I8i3/X5H8CAAbBKpKIATfeVniF0telvhmiWWJq3q20S8TCMFzjoNliTkfIZCQwLDKeRUMr/RkA/tf/+1lE4vefBvk1yVP6v9WaU3RAdAeBAoiEJLvvCzx56W/l76voP7TDASKJhCS5xYuS7xdIPxjkQ0CbQnU6fbyUF9f37bVq1ePnjx58pLe3t7+kZGR6aGhod4lS5ace+bMmeMTExOzBw4c6J+dnZ0eGBjYf/To0T2nT5++WRQn2pLsrID5/7j0Zsm3/D1g/XJnVXEUBIIkEKLvvCyxPef5iV8l/ZkUyhWnIJNIUFERCNFzXpb4FdLLpRulN0rHo6JKsBDImcCmVatW3bps2bKTV1555dTY2NjsoUOHZmdmZjQmPXvz597vcldcccWUj/PxinFTxnF+r+obl74o/XDGdVMdBMomEKLvWJa47LOC9vMkEKLnfEGGZYnzzDp1R09gzeDg4NjatWunrrvuujOHDx8+e2Sa4BMf5+Ndj+sTlW5v0fs2yE2Sl0h9ieQlU9kgUBUCIfpu4bLE7xbox1YFNv2AgAiE6DknhmWJOT0h0IbA6IoVK+7fsWPHqcnJyQRD0vZFXI/rc71q2ytrpN18G+S1kp9L/QNpVdoKKA+BwAmE6LuFyxJfEjg/woNAWgIheo5lidNmkfK1I9CrweTO4eHhqb1797YfgXZQwvW6frcjukme+XWZK6RDkp+N+/baZYUOV51AiL5jWeKqn3X17l+InmNZ4nqfk/Q+IYFe3abftX79+skjR450MAxNfogfDVi3bt2k21NsrQasG7X/U9LnpB9M2A+KQSAmAqH5buGyxH6hY2lMMIkVAgkIhOa5+WWJv6bYPyhdmKAPFIFAPQlo4Hi9B6rHjh1LPursoqTb8YB17gprI/Rv0wd/Innuxp+XmJ6jkRB/V4JAQL5rXJb4/EoAphMQaCAQkOcc2bOkz0qfkZ5JsiAAgdYERn1rPu8rqo1jW19hdbsKbf4ZVt8G+R3JU139vuRVcdggUFUCIfjOdzbmlyX+G/03yxJX9WyjXyYQguccx8XSbdLdEssSc25CIAGBNX7pKa9nVBsHqI1/j4+Pz869dOU3+78q/al0UYK4KQKBmAmE4LtjAvgJyXMUPz9mmMQOgQQEQvDcNxXnWyS/KMyyxAmSRhEIPETA00n5Lf3GQWSRf1911VUzy5cv99XU7yctEKgDgRB8t337dv9Q9PPgLEtch5Ou5n0MxXP6rjukVLAscc3PR7qfjsAmz3+a1fRUnQ5w3f7555/vxwH8QhUbBKpOIBjf2f/4ruqnG/0TATzHaVBrAlG/+KOVpW645pprNlx66aWt3sjPPcFLly7t0cpX5+zbt2/19PS0Fw5gg0BlCYTkOy2TjO8qe6bRsXkCeI5zAQLxEhjyUqidrkzV6VXUZsc5DscjnJ46hw0CVSWA76qaWfoVKgE8F2pmiKswAp4fLcqtr69v2+WXXz6j2+9BxO84RkdHZxTX1iACIggI5EAA3+UAlSoh0IIAnmsBh121IRDtYHX16tWjmzdvXh5SprZs2bJct2tGQ4qJWCCQJQF8lyVN6oJAewJ4rj0jSkAgWAJ6C/jooUOHmt2VL+XzgwcPzq5cudJTe7BBoJIE8F0l00qnAiaA5wJODqEVRiDWK6vDvb29/RdeGNaqbhdddFGPRskDyt4FhWWQhiBQHAF8VxxrWoKACeA5zgMIiECsg9UNIyMj0xqwBpVEx6O4TimoDUEFRjAQyIYAvsuGI7VAICkBPJeUFOUqTSDWwerg0NBQWCPVudNkLi6WWa20bWrbOXxX29TT8ZII4LmSwNNsWAT6wgoncTRL+/v7gxysLlmy5Fz1YnfinlAQAhER0PkdZLT4Lsi0EFQGBEL13Nx3cH8GXaQKCLQlEOuV1Qc1+f5s296VUECTlB9Xs5slD6YRDKp0DmyZO79LcFbrJvEd/6+p6P9vg/Xc3HfwdGtnshcC2RCIdbB6YmJiIsjB6lxcJ7JJD7VAICgC+C6odBBMDQjguRokmS62JxDkrfT2YfcMa4qoO48fP74spJesNBNAz+Dg4PTU1NTF6sO9CfpBEQjERADfxZQtYq0CATxXhSzSh64JxHpl9R4NDKfvvvvurgFkWcFdd93Vo8Gzl1xloJolWOoKhQC+CyUTxFEXAniuLpmmny0JxDpY7RkYGNi/b9++lp0reucdd9zRo4fO9xfdLu1BoCgC+K4o0rQDgYcJ4DnOBAjEO89qz9GjR/fs3r37gZCSeNtttz1w7NixPSHFRCwQyJIAvsuSJnVBoD0BPNeeESUgEDKBoWXLlp08fPhwKUurNjbqOByPgA2FDI3YINAlAXzXJUAOh0BKAnguJTCKV49AtI8BKBUTuuW+56abbpoJIS033njjGcVzu+MKIR5igEBOBPBdTmCpFgJNCOC5JmD4GAKxENi0du3aqcnJycYLnYX+7fYdh6BtjAUccUKgCwL4rgt4HAqBDgjguQ6gcQgEgiGgqaLGduzYcarQ0WlDY1dfffUpxcGqVcGcFQSSNwF8lzdh6ofAowngOc4ICMRNYM2KFSvu37t3bynj1fHx8Vm3L4TnxY2R6CGQigC+S4WLwhDomgCe6xohFUCgXAKjw8PDU0eOHCl0wOqXqtyuun5Zud2ndQiUQgDflYKdRmtMAM/VOPl0vQIEdHVz57p16yY1dVQhA1a34/bcbgXw0QUIdEQA33WEjYMg0DEBPNcxOg6EQBAEevVMzy4PIPOezsr1ux0t+bpLPY91ydogkkYQ0RPAd9GnkA5ERgDPRZYwwoVAI4Fe/+r0rfm8nmH1M6quf+6KKgPVxgzwdx0J4Ls6Zp0+l0kAz5VJn7YhkBGBUb/05Lf0s5rWyvW4vrmXqXhGNaNEUU2lCOC7SqWTzkRAAM9FkCRChEArAms81YfnP7322mtPd/powH333Tfr413P3PRUa1o1yj4I1JwAvqv5CUD3CyeA5wpHToMQyJ7AxlWrVt3ipVC3bNkyNTY2Nnvw4MHZmZmZRV/E8ufe73Iu7+N8vMJiwv/sc0ON1SWA76qbW3oWJgE8F2ZeiCoDAnV65nKor69vqwaeo9PT05dopDowMjJyamhoqHfJkiXnnjlz5vjExMTsgQMHlvX29p7U0qn79cb/ntOnT79PnFlCNYOTjSpqSQDf1TLtdLpEAniuRPg0nQ+BOg1WGwleoA82SIOSV5/aLJ2QviDd21iYvyEAgUwI4LtMMFIJBBITwHOJUVEQAmETmA07PKKDQCUJ4LtKppVOBUwAzwWcHEJrTuCc5rvYAwEIQAACEIAABCAAgXIJMFgtlz+tQwACEIAABCAAAQi0IMBgtQUcdkEAAhCAAAQgAAEIlEuAwWq5/GkdAhCAAAQgAAEIQKAFAQarLeCwCwIQgAAEIAABCECgXAIMVsvlT+sQgAAEIAABCEAAAi0IMFhtAYddEIAABCAAAQhAAALlEmCwWi5/WocABCAAAQhAAAIQaEGAwWoLOOyCAAQgAAEIQAACECiXAIPVcvnTOgQgAAEIQAACEIBACwIMVlvAYRcEIAABCEAAAhCAQLkEGKyWy5/WIQABCEAAAhCAAARaEGCw2gIOuyAAAQhAAAIQgAAEyiXAYLVc/rQOAQhAAAIQgAAEINCCAIPVFnDYBQEIQAACEIAABCBQLgEGq+Xyp3UIQAACEIAABCAAgRYEGKy2gMMuCEAAAhCAAAQgAIFyCTBYLZc/rUMAAhCAAAQgAAEItCDAYLUFHHZBAAIQgAAEIAABCJRLgMFqufxpHQIQgAAEIAABCECgBQEGqy3gsAsCEIAABCAAAQhAoFwCfeU2T+sQ6IjAsI7aIA1KS6UHpRPSfunejmrkIAhAoBUBPNeKDvsgkA8BfDfHlcFqPicYtWZLYEjVbZNGpUukfmla6p3TrP615j/3oHWPdLM0IbFBAALpCOC5dLwoDYEsCOC7LChWuA4PdNjCI7BJId0qnZSmpPlBaZJ/Xd7H+XjXwxYeAXwXXk7wXHg5yTIiPJclzezqwnfZsax0TRg4rPSuUThjkgecZ6Qkg9NmZXy863F9rpctHAL4Lpxc4LlwcpFnJHguT7rp68Z36ZnV+ggMHE76fav/fumU1GwA2snnrs/1XhZOV2sfCb4L4xTAc2HkoYgo8FwRlJO1ge+ScaLUAgIYuPzTwc+f7pTS3u5PO3B1/W7H7bGVSwDflcsfz5XLv4zW8VwZ1B/dJr4rPwfRRoCBy02dzbtLmpTSDj47Ke923B4D1nLzju/K44/nymNfZst4rkz6D3/n8F1Xbg6ibh0Dl5u+69V8UQPV+cGt2/MVVrbyCOC78tjjufLYl9kyniuTfk8PviuXf/StY+DyUujndvK+9d/s6qvb5RnW8nKP78phj+fK4R5Cq3iuvCzgu/LYV6ZlDFxOKv0mpF96ajaYLOJzt88sAeXkH98Vzx3PFc88pBbxXDnZwHflcK9cqxi4nJR6Oqms3/pPO8B1+7vL6X7tW8V3xZ8CeK545iG1iOfKyQa+K4d75VrFwMWn1JMgl3X7v3FA6zg2Fo+g9i3iu2JPATxXLO8QW8NzxWcF3xXPvLItYuDiU+uVpbqd8L9x0Nnp36cVyy3FI6h9i/iu2FMAzxXLO8TW8FzxWcF3xTOvbIsYuNjUev1jL4Xa6eAyj+Mcj+NiK44AviuONZ4rjnXILeG5YrOD7zLifU5G9VANBNIQ2KbCM2kOKKCs49laQDs0AYEyCGxTo3iuDPK0WWcC+K7O2c+h7/zazAFqiyr3al8eV0e7rXO8Rczsyp4AvsueabMa8VwzMvX6HM8Vm298lxFvVvB5GKQNDIuMTqoE1RxVmVUJyhVdxHGdV3SjNW4P3xWXfDxXHOuQW8JzxWYH32XEm8cAMgJJNYkJDKtkf+LSxRYcUHMXFNskrUEgdwJ4LnfENACBswjgu7OQdP4Bg9XO2XFkZwQ26LDpzg7N/SjPuer42CBQJQJ4rkrZpC+xEMB3GWaKwWqGMKkqEYFBlQr1kQvH5fjYIFAlAniuStmkL7EQwHcZZorBaoYwqSoRgaUqFfJgNdRHFBLBpRAEFiGA5xaBwkcQyJkAvssQMIPVDGFSVSICD6pUqG+kOq5QH1FIBJdCEFiEAJ5bBAofQSBnAvguQ8AMVjOESVWJCJxQqZAHq46PDQJVIoDnqpRN+hILAXwXS6YiijPUwVNECBOH6jckQ1u9yvm3/IIVswEkTmXXBfFd1wgTVYDnEmGqRSE8V1ya8V2GrEN9djDDLiaqygaGRSJUmRRi7rlMMEZfCb4rLoV4rjjWIbeE54rNDr7LiDePAWQEkmpSEdifqnRxhUONqzgCtFRVAqGe26HGVdXzgH4VSyDU8zvUuJpmh8FqUzTsyJHAHtX9QI71d1K143FcbBCoIgE8V8Ws0qfQCeC70DMUWXw8x1NswobUXGjPrToex8VWHAF8VxxrPFcc65BbwnPFZgffZcSbK6sZgaSaVAQmVNq/OGdSHZVf4TOq+nbJcbFBoIoE8FwVs0qfQidg331YCuVHAt91oZ8xbeIL5URqE2Zldj9NPflnyYNVsy9bU4phY2XoxtMRfFdcrs5TUx8MwGvzXsdzxeV+YUt4rjjuvhj4Iukb0ulAvIfvist/Li1h4FywnlWpp/J4r3SvtF0akzxdVJmDVbe/+6xI+aAIAvguf8rfoiZeKvkL813SX0p4Ln/uobaA54rJzDPVzD9Kn5WeJfFdVwz3yreCgfNN8XJV/zrJt0Suk86da26N/r1fKnOw6vZ91YmteAL4Ll/mz1f1X5L+Tlo/1xSey5d56LXjuXwzdJGq/1Ppa9LPSfOPWuK7fLnXpnYMnE+qPXftz0h3Sb56+cRFmhnVZ741UcaA1e1etkhMfFQMAXyXD+enqNqPSF+eO78b55DGc/lwj6FWPJdPllaq2t+XfEHm9dKKRZrBd4tA4aN0BDBwOl5JSj9Dhf5BukP6b20O2Kn9k1KRA1a353bZyiOA77Jlf76qe4d0WHqZtLRF9XiuBZwK78Jz2SbXV05/Xvq69H7p8W2qx3dtALG7NQEM3JpPmr026wckm3erlGTGCV/52SUVNWB1O26v8YqTPmIrkAC+ywa2B6UvlzxIfbuUZAo2PJcN+9hqwXPZZezZqsoXYz4tPT1htfguISiKLU4AAy/OJc2nvg3yBsm3Qfyv/06z2cT+1Zn3IwGu3+0wUE2TnXzK4rvuuPocvlz6d+mvpSenrA7PpQRWgeJ4rvsk+nG2Meku6Uop7XcJvus+B7WtAQN3nnpfOfUVVF9J9RXVCzuv6qEj/VyPX3rK+o1l1+d6eUa1ywRleDi+6xzmBh36cemA9KOdV/PQkXiuS4ARHY7nOk/WKh36B5IvyPymNNB5VQ8die+6BFjHwzFwZ1n3s6j7pM9IfkY1q81vTvqXq6+Cdjs/nY93PX7By/WyhUMA36XPxWN1yLslT0V1tdSXvopFj8Bzi2Kp3Id4Ln1Kl+iQl0j/Jb1HuiB9FU2PwHdN0bBjMQIYeDEqzT+7WLs8+LtbeqGU9jZI85ofvWej/rxF8lKoaR8PcHkf5+NdD1t4BPBd8pwsU9FXS0ek66W8plvDc8lzEmNJPJcua/9dxb8g7ZWemu7QVKXxXSpc9S2MgZPl/lwV8zypvg3ieVM9f2oRm18YeYU0Ln1T8i39o9Ix6fjcv/7bn3v/uOTySV40UTG2kgjgu/bg/UPwp6X/lD4kfWf7QzIpgecywRhcJXguWUqepGJ7pDuln5TyuiDTGA2+ayQy93dRCWjSfDAf28CwaJ4O3wb5BckvTn1Ueq10T/Piue/xbRg/szco9UvT0gnJv4C9OhZbHATwXes8PU273yL5WTm/7f+J1sVz3YvncsVbWOV4rjVq37H4belnpTdJb5P8/VLWhu/KIh9ou/zabJ6Y52rXfunvpe9rXow9EEhNAN8tjszLEt8s+YfXiyX/WGSDQBYE8NziFOeXJb5Pu/9YeszixfgUAuUSwMBn8/ftRt92PCj5NiRXns9mxCfdEcB3j+bXbFni7ihzNAQeIYDnzj4bvCzxv0ofk9afvZtPIBAOAQz8SC58G+QGyS9y+IUOv9jBBoE8COC7h6n6h6BfVLxLuk26OA/Y1AkBEcBzj5wGI/rPv5G8LPELJC7IYJHgCWDgh6fA8VQ4nhLHU+N4ihw2CORJAN89POWblyX2FHDtliXOMxfUXQ8CeK6nx8sSv1NKsixxPc4KehkNgbob2JOKH5A8yfgl0WSNQGMnUGffefEML6LxNWmr5MU12CCQN4E6e87LEnuWGA9S/eIUs8XkfbZRf+YE6mpgL8/oZRq/Ink1DW6DZH5qUWELAnX03Urx8KwanS5L3AInuyDQlkAdPefvNS9L7O+5D0tplyVuC5UCECiKQN0M7F+Ub5f8C9NT4vgXJxsEiiZQJ9/5yuk2yVdSs1iWuOhc0V41CNTJc86Y7xR6yjffOXxeNVJIL+pMoC4G9qD0ZZIHqe+Q/OwOGwTKIlAX380vS+xnU7NclrisvNFuvATq4jm/c7FLynpZ4ngzT+SVIFB1A/s2yGXSv0sfkZ5SiazRidgJVN13fqt/flnin9F/85hN7Gds/PFX3XOeveY10vyyxKvjTxk9gMAjBKpsYK/09HfSlyTPJ8cGgVAIVNV3C5cl/i3BLmpZ4lDyShzhEqiq5/xDcLNU9LLE4WaayCpJoIoG9goc75J8G+SlklfoYINASASq5juvNLVd8spT75W8EhUbBEIiUDXPma2XJfYKi15p0SsuskGgsgSqZOB+ZekaybdBPLm/J/lng0CIBKrku/lliT8p0P7yZINAiASq5DmWJQ7xDCOmXAlUwcC+DfJT0p3SHulJuRKjcgh0T6AKvvOyxLdLvv1o//FcavfnBTXkR6AKnlu4LPG1QuXHbtggUAsCsRv4qcrSXukL0g/VImN0sgoEYvbdwmWJfSeDZYmrcEZWvw8xe87Tv71IultiWeLqn6v0cBECsRrYt0HeK/kZuaskPzPHBoFYCMTouz7B3SH5WXA/E86yxLGcbcRpAjF6znF7yrfPSCxLzHlcawKxGXhA2fJbxl4F503Sqlpnj87HSiA2380vS+zZNTzLBhsEYiMQm+e8LPEHJZYlju1MI95cCMRiYD8P5/ka75LGpCfmQoNKIVAMgVh8N78ssecpZlniYs4NWsmHQCye87LEvyf5gszrpRX54KBWCMRFIAYDP11IPy19Tnp2XHiJFgKLEgjddyxLvGja+DBiAqF7bn5Z4q+L8fulx0fMmtAhkDmBkA1ss9q0Nu82yWZmg0AVCITqOy9L/HKJZYmrcJbRh4UEQvWcY/RFmDskL0vsizNsEIBAA4EQDezbHr794dsgvh3i2yJsEKgSgdB858dsWJa4SmcYfWkkEJrnHN/Fkpcl9uNtLEvcmDH+hsACAiEZ2FdOt0p+oNwPlvsBczYIVJFASL5jWeIqnmH0qZFASJ7z/Kh+QdgXZPzCsF8cZoMABFoQCMXAz1KMn5U8RcczW8TLLghUgUAIvlu4LLGnpGJZ4iqcWfShGYEQPMeyxM2yw+cQWISA5yj1VDSbJRvY//rvCxYpm/dHvg3iSY492bEnPea51LyJU39ZBELxHcsSl3UG0G7RBELxnPvtRWv2S5+UWJa46DMh4vb8jFZdtqG+vr5tq1evHj158uQlvb29/SMjI9NDQ0O9S5YsOffMmTPHJyYmZpMlyf4AAAocSURBVA8cONA/Ozs7PTAwsP/o0aN7Tp8+fbMA+TZFHptvg/yG5An93ypdLz2QR0PUCYGSCITmO/8/7yelN0tflF4leUoqNghUhUBonjNXL0u8U1ov2XN/LoVwlbcqOacfFSCwadWqVbcuW7bs5JVXXjk1NjY2e+jQodmZmRmNSc/e/Ln3u9wVV1wx5eN8vDhsypCFb4O8WLpHep/0uAzrpioIhEAgRN/5Ss5eiWWJQzhDiCFrAiF6jmWJs84y9VWOwJrBwcGxtWvXTl133XVnDh8+fPbINMEnPs7Hux7XJ0pruiR1qY7/vPQpaWOXdXE4BEIjEKLvFi5LvF3AWJY4tLOGeLohEKLnWJa4m4xybG0IjK5YseL+HTt2nJqcnEwwJG1fxPW4Ptcrip7eJu3m2yAfkg5Kfj62To9gpGVF+TgJhOa7hcsSXyekfuyGDQJVIhCa58zW7358SWJZ4iqdafQlUwK9GkzuHB4entq7d2/7EWgHJVyv63c7ijzJgHO1yvlZ1CPSa6RlmfaYyiBQPoHQfGdfzi9L7PkbWZa4/HOECLIlEJrn3LunSB+RWJY421xTW8UI9Oo2/a7169dPHjlypINhaPJD/GjAunXrJt2eGDYbsPo2yNXSNySX+9aK8aY7EDCB0Hz3DMXkFXDukFiWmHO0igRC89z5gvwOySu+vUzyCnBsEIDAYgQ0cLzeA9Vjx44lH3V2UdLteMA6d4W1MaTn6YMD0iek72ncyd8QqAqBgHznZYk/ILEscVVOLvqxKIGAPLdwWeK3K1gPWtkgAIEWBEZ9az7vK6qNY1tfYXW7imv+GdYn678/LP2HdLnU7Kpri66wCwLREAjBd16G+A2Sp5djWeJoTh0C7ZBACJ7z99qo5Nv9fy359j8bBCDQhsAav/SU1zOqjQPUxr/Hx8dn1f43FeO7JN8GeaXkCcfZIFBlAqX7bvny5f6h6CupLEtc5TONvs0TKN1z+q47pmDGJb9A5Rep2CAAgSQEPJ2U39JvHEQW+ff27dtn9cXpq6lrk8RMGQjETiAE31111VUzK1eu/HjsLIkfAkkIhOA5f9dpwPo5xet3MtggAIGEBDZ5/tOspqfqdIDr9h2HYmbe1ISJo1jUBPBd1Okj+AgJ4LkIk0bI2RGIenJsrSx1wzXXXLPh0ksvLfXZ0KVLl/ZoudZz9u3bt3p6etoLB7BBoLIE8F1lU0vHAiWA5wJNDGFBIAGBIS+F2unKVJ1eRW12nONwPIp7KEHsFIFArATwXayZI+5YCeC5WDNH3JkROCezmgquqK+vb9vll18+c/75YcyW4ThGR0dnFNfWglHQHAQKI4DvCkNNQxB4iACe40SAQE9PtIPV1atXj27evHl5SEncsmXLct2u8ZQebBCoJAF8V8m00qmACeC5gJNDaBBoR0BvJB49dOhQs7vypXx+8ODBWb2d7Gms2CBQSQL4rpJppVMBE8BzASeH0AojEOuV1eHe3t7+Cy+8sDBQSRq66KKLejRKHlDZC5KUpwwEIiOA7yJLGOFGTwDPRZ9COpAFgVgHqxtGRkamNWDNgkFmdTgexXVKFW7IrFIqgkA4BPBdOLkgknoQwHP1yDO9bEMg1sHq4NDQUFgj1TnQc3ENtuHObgjESADfxZg1Yo6ZAJ6LOXvEnhmBWFehWNrf3x/kYHXJkiXnKju7M8sQFUEgIAI6vwOK5pFQ8F2QaSGoDAiE6rm572CWFs8gx1TRnkCsV1Yf1OT7s+27V3wJLQ5wXK1uljyYRjCo0jmwZe78Lt5YbVrEd/y/pqL/vw3Wc3PfwdNtrMluCGRCINbB6omJiYkgB6tzcZ3IJDtUAoGwCOC7sPJBNNUngOeqn2N6mIBAkLfSE8Q9rCmi7jx+/PiykF6y0kwAPYODg9NTU1MXqw/3JugHRSAQEwF8F1O2iLUKBPBcFbJIH7omEOuV1Xs0MJy+++67uwaQZQV33XVXjwbPXnKVgWqWYKkrFAL4LpRMEEddCOC5umSafrYkEOtgtWdgYGD/vn37Wnau6J133HFHjx463190u7QHgaII4LuiSNMOBB4mgOc4EyAQ8XKrR48e3bN79+4HQkribbfd9sCxY8f2hBQTsUAgSwL4Lkua1AWB9gTwXHtGlIBAyASGli1bdvLw4cOlLK3a2KjjcDwCNhQyNGKDQJcE8F2XADkcAikJ4LmUwChePQLRPgagVEzolvuem266aSaEtNx4441nFM/tjiuEeIgBAjkRwHc5gaVaCDQhgOeagOFjCMRCYNPatWunJicnGy90Fvq323ccgrYxFnDECYEuCOC7LuBxKAQ6IIDnOoDGIRAIhoCmihrbsWPHqUJHpw2NXX311acUB6tWBXNWEEjeBPBd3oSpHwKPJoDnOCMgEDeBNStWrLh/7969pYxXx8fHZ92+EJ4XN0aih0AqAvguFS4KQ6BrAniua4RUAIFyCYwODw9PHTlypNABq1+qcrvq+mXldp/WIVAKAXxXCnYarTEBPFfj5NP1ChDQ1c2d69atm9TUUYUMWN2O23O7FcBHFyDQEQF81xE2DoJAxwTwXMfoOBACQRDo1TM9uzyAzHs6K9fvdrTk6y71PNYla4NIGkFETwDfRZ9COhAZATwXWcIIFwKNBHr9q9O35vN6htXPqLr+uSuqDFQbM8DfdSSA7+qYdfpcJgE8VyZ92oZARgRG/dKT39LPalor1+P65l6m4hnVjBJFNZUigO8qlU46EwEBPBdBkggRAq0IrPFUH57/9Nprrz3d6aMB991336yPdz1z01OtadUo+yBQcwL4ruYnAN0vnACeKxw5DUIgewIbV61adYuXQt2yZcvU2NjY7MGDB2dnZmYWfRHLn3u/y7m8j/PxCosJ/7PPDTVWlwC+q25u6VmYBPBcmHkhqgwI1OmZy6G+vr6tGniOTk9PX6KR6sDIyMipoaGhXi2T2qvPZicmJmYPHDiwrLe396Q+2683/vecPn36feLMEqoZnGxUUUsC+K6WaafTJRLAcyXCp+l8CNRpsNpI8AJ9sEEalPqlaemE9AXp3sbC/A0BCGRCAN9lgpFKIJCYAJ5LjIqCEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQgAAEIAABCEAAAhCAAAQgAAEIQAACEIAABCAAAQhAAAIQqDSB/w/WOa9wOJJpFgAAAABJRU5ErkJggg==)

The black circles are the observed nodes $$y_i$$. These are the noisy pixels of an image. We want to infer the latent variable $$x_i$$ for each of the observed nodes. Which are the denoised pixels and depicted as a white circles. The connections of the $$x_i$$ to the neighbors are made because the change of color from pixel to pixel is considered sparse. One pixel may tell its neighbor the belief of its color. Please see [Loopy Belief Propagation in Image-Based Rendering](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.88.6471&rep=rep1&type=pdf) by Dana Sharon for a detailed explanation.

We turn now the MRF into a loopy factor graph.

![image.png](data:image/png;base64,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)

The white circles remain the hidden variables we want to infer. The black circles are turned now into squares colored in black. These are factors and related to a probabilty of the observations. The white squares are factors that define how neigboring pixels are related.

### Variables and Factors

I will use a binary black and white picture in order to simplify the computation and ease the understanding. Thus all the variables are binary and the factors may consists only of a two-by-two matrix.

A variable is defined by

$$
x_{ij} = 
\begin{pmatrix}
p(white) \\
p(black) \\
\end{pmatrix}
$$

It contains for row $$i$$ and column $$j$$ a probability that the pixel is black or white.

The factor colored in white is defined by:

$$
\psi_{kl}^h = 
\begin{pmatrix}
s_{remains\_white}(x) & s_{changes\_to\_black}(x)\\
s_{changes\_to\_white}(x) & s_{remains\_black}(x) \\
\end{pmatrix}
$$

It gives a score for all possibilities a hidden variable may change or not change its color. The appropriate values will be defined later.

The factor colored in black is defined by:

$$
\psi_{ij}^o = 
\begin{pmatrix}
s(white) \\
s(black) \\
\end{pmatrix}
$$

This takes just the probability of the observed pixel. $$s(white)$$ is $$0.6$$ if the the pixel is white, $$s(white)$$ is $$0.4$$ if the observed pixel is black. And similarly for the score $$s(black)$$. These values are just arbitrarily defined. One should find the true probabilities to improve the performance.


## Python implementation

This implementation is naÃ¯ve. It just aims to make things clear without the need of hiding the operations in optimizations.  

Still I can simplify the code from previous [post](https://mayio.github.io/2022-09-17-Loopy-Belief-Propagation/) a little. I don't want to use the named tensor concept here. Simply because the names would be meaningless in this example. And also products can be simplified as the factors are two dimensional at maximum. Summing over the product becomes a matrix to vector multiplication - which I have shown in the previous post. Please see the section Factor-to-Variable Message Example 1.


### Graph implementation

The graph must reflect the structure of the lattice. The observed factor nodes are 2x1 arrays. We add them to a array in the size of the image. The hidden factors (non shaded) are 2x2 arrays. It turns out that we don't need to reserve space in the lattice for these factors as they are everywhere the same. Defining only one is enough. For each observed pixel we need a variable that represents the final belief of a pixel. This can also be expressed with a 2x1 array. Last, each node is connected at maximum to four (unshaded) factors. That means we need at maximum four additional incoming messages and four outgoing messages, each of the size of a 2x1 array, for each node. 

A node element can be defined with an array containing 9 messages and 1 marginal, where each element is a 2x1 array like this:

```
array([[[0.],  # Variable marginal
        [0.]],

       [[0.],  # Observed factor incoming message
        [0.]],

       [[0.],  # Upper incoming message
        [0.]],

       [[0.],  # Upper outgoing message
        [0.]],

       [[0.],  # Left incoming message
        [0.]],

       [[0.],  # Left outgoing message
        [0.]],

       [[0.],  # Lower incoming message
        [0.]],

       [[0.],  # Lower outgoing message
        [0.]],

       [[0.],  # Right incoming message
        [0.]],

       [[0.],  # Right outgoing message
        [0.]]])
```


```python
import numpy as np
from enum import IntEnum
```


```python
class MsgType(IntEnum):
    MARGINAL = 0
    OBSERVED = 1
    NEIGHBOR = 2

n_rows = 100     # number of image rows
n_cols = 100     # number of image columns
n_messages = 10  # number of elements to describe a node
n_dims = 2       # element dimension

# The graph
# All messages are intialized with [0.5, 0.5].Transpose
graph = np.ones(n_rows * n_cols * n_messages * n_dims).reshape(n_rows, n_cols, n_messages, 2, 1) * 0.5
```

### Loading an Image Into the Graph

Lets load a self drawn 100 x 100 image, add some noise and convert it to a binary image.


```python
from matplotlib import pyplot as plt
from skimage import io
from skimage.color import rgb2gray
from skimage.color import rgba2rgb
import skimage

loopy_image_array_rgb = io.imread('https://raw.githubusercontent.com/mayio/mayio.github.io/master/assets/img/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_files/loopy.png')
loopy_image_array_rgb = skimage.util.random_noise(loopy_image_array_rgb, mode='pepper')
loopy_image_array_gray = rgb2gray(rgba2rgb(loopy_image_array_rgb));
loopy_image_array_bw =  (loopy_image_array_gray > 0.5) + 0.;

fig = plt.figure(figsize=(15, 10))
plt.imshow(loopy_image_array_bw)
plt.show()
```


![png](https://raw.githubusercontent.com/mayio/mayio.github.io/master/assets/img/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_files/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_12_0.png)


The pixel values must be loaded into the incoming message of the "observed" factors. We reduce the probability a bit, as we are not shure about the right value.


```python
for i in range(n_rows):
    for j in range(n_cols):
        pixel_value = loopy_image_array_bw[i][j]
        graph[i][j][MsgType.OBSERVED][0][0] = pixel_value * 0.2 + 0.4
        graph[i][j][MsgType.OBSERVED][1][0] = (1. - pixel_value) *  0.2 + 0.4
```

### Message Computation

The variable-to-factor message is given by:

$$\mu_{x \to f}(x) = \prod_{g \in \{ne(x) \setminus f\}} \mu_{g \to x}(x)$$

where $$ne(x)$$ are the neighbors of $$x$$.

And the factor-to-variable message is given by 

$$\mu_{f \to x}(x) = \sum_{\chi_f \setminus x}\phi_f(\chi_f) \prod_{y \in \{ne(f) \setminus x \}} \mu_{y \to f}(y)$$

See below how this is implemented for the lattice.

#### Variable to Factor

The incoming messages of a variable (coming from the hidden (unshaded) and observed (shaded) factors) are simply multiplied element-wise, excluding the incoming message from the factor we want to send the message to. 

You will find a normaliziation in the code below. That is actually not needed. But without we would run into numerical problems as the multiplication makes the values small. One would compute these values rather in log-space to avoid numerical problems.

For a given variable and message we may do:


```python
def variable_to_factor_message(i, j, k, max_rows, max_cols):
    # get the indices for the neighboring node
    i2 = i - 1 if k == 0 else i   # top
    i2 = i + 1 if k == 2 else i2  # bottom
    j2 = j + 1 if k == 1 else j   # left
    j2 = j - 1 if k == 3 else j2  # right

    # check the neighboring node exists
    if i2 < 0 or j2 < 0 or i2 >= max_rows or j2 >= max_cols:
      return

    # get the variable
    variable = graph[i][j]

    # get the observed incoming factor
    res = np.copy(variable[MsgType.OBSERVED])

    # iterate through all neigbors except the given k
    # do a element-wise product
    for l in range(4):
      if l != k:
        res  = res * variable[MsgType.NEIGHBOR + l * 2]

    # store the result in the outgoing message
    norm = res[0][0] + res[1][0]
    variable[MsgType.NEIGHBOR + k * 2 + 1][:] = res / norm

```

#### Factor to Variable

The hidden factors are indirectly accessed. We have to find the neighboring nodes and access the respective messages. If we have the right messages, we may do a simple matrix to vector multiplication here. There is even no need to transpose the factor depending on the edge direction as the factor is a symetric matrix.

Again, the normalization is actually not needed. One might choose the sum of log-likelihoods for the product and use the log-sum-exp trick for the summation.


```python
hidden_factor = np.array([[0.6, 0.4],[0.4, 0.6]])

def factor_to_variable_message(i1, j1, k1, max_rows, max_cols):
    # get the indices for the neighboring node
    i2 = i1 - 1 if k1 == 0 else i1  # top
    i2 = i1 + 1 if k1 == 2 else i2  # bottom
    j2 = j1 + 1 if k1 == 1 else j1  # left
    j2 = j1 - 1 if k1 == 3 else j2  # right

    # check the neighboring node exists
    if i2 < 0 or j2 < 0 or i2>= max_rows or j2 >= max_cols:
        return

    # this node
    variable_receive = graph[i1][j1];

    # neighboring node
    variable_source = graph[i2][j2];

    # the opposite edge - the index of the outgoing message of
    # the neighboring node
    k2 = (k1 + 2) % 4 

    # matrix multiplication of hidden factor with the outgoing message
    # of the neighboring node
    variable_receive[MsgType.NEIGHBOR + k1 * 2][:] = np.matmul(
        hidden_factor,
        variable_source[MsgType.NEIGHBOR + k2 * 2 + 1])
    
    norm = sum(variable_receive[MsgType.NEIGHBOR + k1 * 2])[0]
    variable_receive[MsgType.NEIGHBOR + k1 * 2] /= norm
```

#### Marginal

The marginal of a variable is given by

$$
p(x) \propto \prod_{f \in ne(x)}\mu_{f \to x}(x)
$$

This is very similar to the computation of the variable to factor message. Now we multiply all incoming messages element-wise.


```python
def marginal(i, j, max_rows, max_cols):
    variable = graph[i][j];
    res = np.copy(variable[MsgType.OBSERVED])

    for k in range(4):
        # get the indices for the neighboring node
        i2 = i - 1 if k == 0 else i   # top
        i2 = i + 1 if k == 2 else i2  # bottom
        j2 = j + 1 if k == 1 else j   # left
        j2 = j - 1 if k == 3 else j2  # right
     
        # check the neighboring node exists
        if i2 < 0 or j2 < 0 or i2>= max_rows or j2 >= max_cols:
            continue

        # iterate through all neigbors
        # do a element-wise product
        res  = res * variable[MsgType.NEIGHBOR + k * 2]

    # store the result in the outgoing message
    norm = res[0][0] + res[1][0];
    variable[MsgType.MARGINAL][:] = res / norm
```

### Inference

Now put everything together and run the inference. We iterate in multiple rounds over all variables, compute the variable-to-factor messages and then the factor-to-variables messages.

At last we compute the marginal for each variable. This is usually not needed in each iteration for most applications as only the final result is needed. In this toy example we want to show the intermediate results.


```python
iterations = 4
loopy_image_array_update = np.copy(loopy_image_array_bw);

# create figure
fig = plt.figure(figsize=(15, 10))

for n_iter in range(iterations):
    # start with variable to factor message.
    for i in range(n_rows):
        for j in range(n_cols):
            # we have to iterate over all available neighbors of a variable
            for k in range(4):
                variable_to_factor_message(i, j, k, n_rows, n_cols)

    # continue with factor to variable message.
    for i in range(n_rows):
        for j in range(n_cols):
            # we have to iterate over all available neighbors of a variable
            # to compute all factor to variable messages
            for k in range(4):
                factor_to_variable_message(i, j, k, n_rows, n_cols)

    # marginal
    for i in range(n_rows):
        for j in range(n_cols):
            marginal(i, j, n_rows, n_cols)

    fig.add_subplot(1, iterations, n_iter + 1)

    for i in range(n_rows):
        for j in range(n_cols):
            loopy_image_array_update[i][j] = (np.argmax(graph[i][j][0]) - 1) * -1
    
    plt.imshow(loopy_image_array_update)

plt.show()
```


![png](https://raw.githubusercontent.com/mayio/mayio.github.io/master/assets/img/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_files/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_22_0.png)



```python
fig = plt.figure(figsize=(15, 10))
fig.add_subplot(1, 2, 1)
plt.imshow(loopy_image_array_update)
fig.add_subplot(1, 2, 2)
plt.imshow(loopy_image_array_bw)
plt.show()

```


![png](https://raw.githubusercontent.com/mayio/mayio.github.io/master/assets/img/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_files/2022-09-24-Noise-Reduction-Loopy-Belief-Propagation_23_0.png)


## References
 - [Understanding Belief Propogation and its Generalizations](http://people.csail.mit.edu/billf/publications/Understanding_Belief_Propogation.pdf) by Jonathan S. Yedidia, William T. Freeman, and Yair Weiss
 - [Loopy Belief Propagation in Image-Based Rendering](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.88.6471&rep=rep1&type=pdf) by Dana Sharon
 - [Variational Inference: Loopy Belief Propagation](https://www.cs.cmu.edu/~epxing/Class/10708-14/scribe_notes/scribe_note_lecture13.pdf) by  Eric P. Xing 
 - Stereo Matching with Loopy Belief Propagation [blog](http://nghiaho.com/?page_id=1366)
