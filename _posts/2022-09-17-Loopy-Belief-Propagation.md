---
layout: post
title: 'Loopy Belief Propagation - Python Implementation'
date: '2022-09-17 11:02:00 +0200'
categories: graph
---

This is about how to implement Loopy Belief Propagation in Python and to understand the calculations in detail.

<!--more-->

The most parts were done by Jessical Stringham in her Notebook [here](https://jessicastringham.net/2019/01/09/sum-product-message-passing). I adapted it only a little to experiment with loopy belief propagation and added examples to show how the products of the distributions must be calculated. Most credits are hers! I am really thankful that she has provided such a comprehensive example and explanation.

## Motivation

I'll give (copy) here first Jessica Stringham's introduction into this topic and focus then on the algorithm that can perform inference on factor graphs that may have cycles.

[Belief propagation](https://en.wikipedia.org/wiki/Belief_propagation) (or sum-product message passing) is a method that can do inference on [probabilistic graphical models](https://en.wikipedia.org/wiki/Graphical_model). It is applying the sum rules and product rules of probability to compute different distributions. For example, if a discrete probability distribution $$p(h_1, v_1, h_2, v_2)$$ can be factorized as

$$p(h_1, h_2, v_1, v_2) = p(h_1)p(h_2 \mid h_1)p(v_1 \mid h_1)p(v_2 \mid h_2),$$

To compute the marginals, for example, $$p(v_1)$$, we have to multiply the terms and summing over the other variables.

$$p(v_1) =  \sum_{h_1, h_2, v_2} p(h_1)p(h_2 \mid h_1)p(v_1 \mid h_1)p(v_2 \mid h_2),$$

With marginals, one can compute distributions such as $$p(v_1)$$ and $$p(v_1, v_2)$$, which means that one can also compute terms like $$p(v_2 \mid v_1)$$. Belief propagation provides an efficient method for computing these marginals. 

This version will only work on discrete distributions.

## Factor Graphs

Factor graphs are used to represent a distribution for sum-product message passing.
One factor graph that represents $$p(h_1, h_2, v_1, v_2)$$ is

![image.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAt0AAAGgCAYAAAB2Y9twAAAABHNCSVQICAgIfAhkiAAAIABJREFUeF7snQfY1ETXhg8dkWIBAQWRoqCIdJCqNCtIUUBBsGD5BBSVZkFFrDQRBUVsoCKgiBQVVFBBAZUmvYP0Jl2KFPfPk+9/93s3mWxNdpPsc67rvWAnk8nMPZnMyeTMOVkCmgiFBEiABEiABEiABEiABEjAMQJZHSuZBZMACZAACZAACZAACZAACegEqHTzRiABEiABEiABEiABEiABhwlQ6XYYMIsnARIgARIgARIgARIgASrdvAdIgARIgARIgARIgARIwGECVLodBsziSYAESIAESIAESIAESIBKN+8BEiABEiABEiABEiABEnCYAJVuhwGzeBIgARIgARIgARIgARKg0s17gARIgARIgARIgARIgAQcJkCl22HALJ4ESIAESIAESIAESIAEqHTzHiABEiABEiABEiABEiABhwlQ6XYYMIsnARIgARIgARIgARIgASrdvAdIgARIgARIgARIgARIwGECVLodBsziSYAESIAESIAESIAESIBKN+8BEiABEiABEiABEiABEnCYAJVuhwGzeBIgARIgARIgARIgARKg0s17gARIgARIgARIgARIgAQcJkCl22HALJ4ESIAESIAESIAESIAEqHTzHiABEiABEiABEiABEiABhwlQ6XYYMIsnARIgARIgARIgARIgASrdvAdIgARIgARIgARIgARIwGECVLodBsziSYAESIAESIAESIAESIBKN+8BEiABEiABEiABEiABEnCYAJVuhwGzeBIgARIgARIgARIgARKg0s17gARIgATSmMC3334rVatWDf4NGTIkjWmw6SRAAiTgHIHszhXNkt1K4OjRo3LgwAE5ePCg/nfo0CEpXbq0lCtXzq1VZr1IIKUE/DxmVqxYIYsWLQrybdSokSOs/czQEWAslARIwHcEqHS7uEv//fdfXTnOkJw5c0q+fPliqvG2bdukdevWcvjwYV253rdvn5w4ccJURsuWLWXixImmdC8knDlzRn95yJDzzjtPsmTJ4oWqs442E+CYsRlonMX56bnD50ucNwFPIwESMBGgeYkJiXsSBg0aJAULFgz+derUKebKHT9+XH799VdZuXKlbN++Xalwx1yoy07o3bt3CKfRo0e7rIasTrIIcMwki3T46/jpucPnS/i+5lESIIHoCVDpjp5VUnNu2LBBXnrppeA1s2bNKr169Yq5DoULF5aBAwfKI488IlWqVIn5fC+ccOutt4ZU87nnnpMjR454oeqso40EOGZshJlgUX567vD5kuDNwNNJgASCBKh0u/Rm6Ny5s24SkiFt27aVatWqxVzb/PnzS48ePWTo0KGycOFCefPNN2Muw+0n1KpVS5o3bx6s5pYtW+SFF15we7VZP5sJcMzYDDSB4vz03OHzJYEbgaeSAAmEEKDS7cIbYtSoUfLdd98Fa5YnTx7blMiuXbtKnTp1XNjqxKrUr18/yZYtW7CQ4cOHy9q1axMrlGd7hgDHjLu7yuvPHT5f3H1/sXYk4BUCVLpd1lO7d++Wp556KqRW9913n+5dxC6pW7euXUW5ppyrrrpKbr/99mB9jh07Jt27d3dN/VgR5whwzDjH1s6Svfzc4fPFzjuBZZFA+hKg0u2yvoc98s6dO4O1uuCCC6RPnz621rJIkSK2lueWwvr27Su5c+cOVuerr74K+WLglnqyHvYS4Jixl6dTpXn9ucPni1N3BsslgfQhQKXbRX29f/9+GT9+fEiNOnToIIUKFXJRLd1blTJlyohx09Nrr73m3gqzZgkT4JhJGCELiJIAny9RgmI2EiABSwJUui3RJP/A+++/H+JvGjWA0k2JnkD79u1DMiPa3vLly6MvgDk9RYBjxlPd5fnK8vni+S5kA0ggpQSodKcU//8ujqAe7733XkhtKleuLBUrVnRJDb1RjSZNmkixYsVCKvvGG294o/KsZUwEOGZiwsXMNhDg88UGiCyCBNKYAJVul3Q+7I+N3jbgJpASG4Hs2bNLixYtQk6Cyc7evXtjK4i5XU+AY8b1XeS7CvL54rsuZYNIIKkEGAbegPujjz6SkydPBlNLlCghWN2AnD59WmbNmiVTpkyRBQsWyJ49ewSeE+CqDsEg8IcANPCiUbNmzZg68q233grJjzLbtWsXUxnM/F8C4DZs2LAgDvg7f+edd2zfkEreIqkaL2DPMcM7MBUE+HxJBXVekwR8QiBACSGgeQsJaF0b/NM2z+jHN2/eHNCC04Qcy5zP+P/q1asHNm7cGBVdTXkPaBEnQ8pu1KhRVOfGk2nIkCGmdrRs2VJZlPYCElizZk1gxowZgSVLlgTw2wtSrly5kDZefvnlXqi25+qYivECSBwz9t0qgwcPDhkrPXv2tK/wTCX56bnD54sjtwgLJQHfE6B5SYSXJ+0OkDlz5gh8zGJ1O1qZP3++fs7MmTMjnjJ79myBfWpmSaVP2xMnTsjIkSOlatWqgsA8ZcuWlcaNG+v25Yg0h8iY06ZNi9iuVGaoV69eyOVXrVolmzZtSmWV0uLayRgvAMkx47/byUvPHT5f/Hf/sUUkkAwCVLojUN6wYYNcd911snXr1gg5zYd37NghN9xwg0RyWweTFaNA4U2FoC5XXHGFPPjgg7Jo0SLdpCazYGJEOPmmTZu6OvgMzHyM8v333xuT+NtmAskYL6gyx4zNHZfi4rz23OHzJcU3DC9PAh4lQKU7io5DdMPMAr/Zd999t/Tv31//gw23VcRIKK2IjDh69GjLK2El3Siqh7oxj92/4eUDK9rRrAhjZR4vE1988YXd1bClPBW/H374wZayWUh4Ak6PF1ydYyZ8H3jpqBefO3y+eOkOY11JwEUEfG9AE2MDjTaqWleF2Dvec889gaNHjypLXb16daBSpUome2mUoZloBE6dOmU6T/OqYbLnLl68uCmfnQkq28rM7dQ2cQZatWoVGDBgQOCzzz4LaC8WgZIlSyrbpYVHDpw5c8bO6tlS1vHjxwM5c+YMqfOFF17oyrra0uAUFZLs8YJmcszY29mptOn26nOHzxd770GWRgLpQkDSpaHRtjOcEtGrV6+IxRw6dCigmZQoFdQRI0aYzp84caIp70033WTKZ2dCOKVb89QS0ILJmC63a9cuy42kmt26Kb8bErTVKBNbzdbeDVXzTR2SPV4AjmPG3tvHDUq3F587fL7Yex+yNBJIBwI0L4nyq8Pjjz+um5JEEmw0nDp1qtSpU8eUdeDAgfLPP/+EpKuiJVaoUMF0bjIStNVt+frrr6V8+fKmy8Ed4tChQ03pSFi/fr0yPdWJKo5Lly5NdbXS4vpOjRfA45jx1y3k1ecOny/+ug/ZGhJIBgEq3VFQzpcvn/Tu3TuKnP/NggAKqvzYZKaZa4SUowraUrBgwaivZVdGzTWi7nM5R44clkXWrl1batWqZToejQ246aQkJBQtWtR0FfhWpzhLwMnxgppzzDjbf8ks3cvPHT5fknmn8Fok4A8CVLqj6Mc2bdqI9hk9ipz/ywLvHgjjbpRly5aFJP3111/GLHLOOeeY0pxOwKrN2WefHfEyqg2j8Xh2iXghGzKoOFLptgFshCKcHC+4NMdMhA7w0GEvP3f4fPHQjcaqkoBLCFDpjqIjHnjggShyhWbJkiWL7uHEKFjtzixuUSCM9bT6ffHFF5sOZY7gaTqYwgROiqmB7+R4QYs4ZlLTr6m8qhufO3y+pPKO4LVJwJsEqHRH0W8qG+coThMtapkpmxalMiTNawpEOPMTU2NTnFCgQAFTDVS8TZmYkBABJ8cLKqbqQ5UClFAjbDzZS2PGxmbbWpQbGfL5YmsXszASSAsCVLojdLPmZi4qswtVMSpTDCjd2g7dYPZ9+/aZTnWzAmGqrIsTVBxVCpuLm+C5qjk9XgCEY8Zzt4UvK8zniy+7lY0iAUcJUOmOgBdeO+IV1SfRw4cPCyJVZojKNMONqzrxMkjleXnz5jVd/uDBg6Y0JthHwOnxgppyzNjXXywpfgJ8vsTPjmeSQLoSoNIdoee1IAgRclgftlLwtKAtwZPOO+88UwFHjhwxpTEhdgKqvotms2jsV+IZGQRUzKOlE814QVkcM9ESZT4nCajudT5fnCTOsknA+wSodEfowy1btoSYg0TIHnJ427ZtpuzwgoIw8hly/vnnm/JYKR+mjEwIS0DFMRXuGMNW0mcHnR4vwMUx47ObxqPN4fPFox3HapNACglQ6Y4A/9ixYyHmIBGyhxxWKd0lSpQIyZNZAc84oHqYx3Jd5v0vARVHKt3O3h1OjxfUnmPG2T5k6dER4PMlOk7MRQIk8D8CVLqjuBtmz54dRS5zFi08uimxVKlSIWkq/9+qh7mpICZEJKDiqFLYIhbEDDERcHK8oCIcMzF1BzM7RIDPF4fAslgS8DEBKt1RdK5V+PNwp8Leb/z48aYsRqVbpQSqHuamgpgQkcCBAwdMebjSbUJie4KT4wWV5ZixvctYYBwE+HyJAxpPIYE0J0ClO4ob4LfffpMff/wxipz/ywKFe9euXaZzatasGZKm8vYAu1hK4gRU/FWrpIlfiSVkJuDkeMF1OGZ4v7mBAJ8vbugF1oEEvEWASneU/dWrVy+JNoT4pk2b5OWXXzaVXLVqVbnllltC0mvUqGHKt2TJElMaE2InsHTpUtNJ6AOK8wScGi+oOceM8/3HK0QmwOdLZEbMQQIkEEqASneUd8SCBQukXr16smrVqrBnrF69Who3bizr1q0z5Xv22WcF4eEzC5TAokWLhqQtX75cTp06ZTqfCdET+Oeff2TFihUhJ8AsoVq1atEXwpxxE3BqvKBCHDNxdwtPtIkAny82gWQxJJBmBKh0x9Dha9eulQYNGsiwYcNMoaj//vtvee+996RJkyZiDPWOS9SuXdu0yo30rFmz6sp8ZoEHiGXLlsVQs9iyqvyAqz6VqkpFcB+jxBPlccaMGTJu3DhldEFj+fH8Br8TJ06EnFq9enXJli1bPMXxnDgIODFeUI10GzNnzpwRsJw6dap89dVX+rMBzxuvSaqfO3jG4Zkza9ashNHx+ZIwQhZAAmlJgEp3jN2+e/duefjhh+Wiiy6ScuXKSa1ataR8+fKC8Nf333+/qNwEImDCSy+9ZHmlRo0amY4tWrTIlGZHAkLQqyadhQsXCv7Cyb///itz5841ZVm8eLGsX7/elK5K2L9/v9xxxx36ywn+3bx5sypbwmkqfsaXm4QvwgIiEnBivOCi6TBm8FWtdevWUqBAASlbtqz+0t6sWTO56qqrJF++fFKnTh2ZMmVKxD5wQ4ZUP3cmTZqkf+XCM2fIkCEJI+HzJWGELIAE0pJA9rRsdQyNLl68uK5UT58+PeQshKJes2ZNxJLKlCkjn376qWCV1UqggBpF9VA35onl988//6wruGPHjhWVK0O0p2HDhnL33Xfrq/lYmcemQ6y6z58/Xz/3k08+EWySMwq8rUChve+++3RF4JprrpGzzjpLz7Zz505dyUd78Ac7yL179waLyJMnj7E4W36r+F177bW2lM1CrAkkY7zg6n4eM2hf//79pU+fPnL69Gl9HELZrlChghw6dEhf8YZCjhfg5s2b68r4xIkTXfkVJ1XPHTxz/vjjD4GZExYFMpua2fHM4fPF+hnAIyRAAmEIaCsQlEwEtAkuoOEK/pUuXTqgfRYNtGrVKiQ9cx6r/994440BTcGMiu8VV1xhuq62shzVudFksqqjVfrIkSP1YjUlO+Z2a5NdsEqPPvpo2PM1ZT6a6sec57LLLgu5LvpVs5OPuRyeEJ5AqsYLauXXMaO93AbvXW2FO6C93Id0gmZPHLjzzjtD7u9u3bqF76gwRwcPHhxSVs+ePcPkju2Q1fPFKt2O5472YhL2mXPvvffG1ghFbj5fFFCYRAIkEJEAzUvCvJBkHMqbN6988cUXuttAbJLMnTt32LMqVqwogwYN0u0vo/UL3alTp5AyN2zYIPEGGQlbuRgPov6woY1WkDdjlRvnYIVuwIABwT+j95CcOXNGW3TU+ebMmaPbwGYWfKbPnp0fdqKGmEDGZIwXVM+vY6Zv375B+niWaApeSG9gzAwfPjzEdeLbb7+tf5XyiyTy3MmVK1fIM+eVV14x8UuEE58vidDjuSSQ3gSohcTQ/zBPwB82BP3000/6hknYrMLWGb6DixQpIpUrV9ZtvWMVmGa8+uqrIaYXY8aM0U017BDt9SuuYhDMBxu54hWYrOAvQ7ARM7PtuBOKMLgZpUuXLsYk/naYgJPjBVX345iB16PM+yOs9krkz59ff87g+QOBeRjMwOx6Xth1a6TiuQOlW1utDzYBz+cnn3wy+DvRZw6fL3bdHSyHBNKPAJXuOPocm5iwgmunYBJt166dZI7mB9tNTKZOrAbbWfdEykp0AjReG64WJ0+eHJJ8/fXXy+WXX27Myt9JIuDEeEHV/ThmwApfi6AoQsJ5KUH7M8vWrVuT1KPevkwiHoz4fPF237P2JJBqAtHbDaS6pmlwfXhFyTwhwMUVTFQo0ROYNm2a7NixI+SEzp07R18Ac3qKgN/GDL6WafbauuIN//3du3e37A+jm09t/4llXh6whwCfL/ZwZCkkkK4EqHS7qOcxacIbQWYZPXq0i2ro/qp8/PHHIZWEq7WmTZu6v+KsYVwE/DhmMObhenTLli3ywAMPKLnAK9DKlSuDx+CRA16WKM4S4PPFWb4snQT8ToBKt8t6uHfv3iEbF+GHF7aalMgE4CIMrtMyC2y5Y9kIGvkqzOE2An4cM1jltjK9gp10jx495OjRo8GugM2y0dzEbf3k9frw+eL1HmT9SSD1BKh0p74PQmpQo0YN6dixY0ja008/7bJaurM64JRhC4sa1qxZU2ha4s6+srNW6TRmjh8/rnttge//DGnTpo088cQTdiJlWQoCfL4ooDCJBEggJgJUumPClZzML7/8shQqVCh4se+//17wR7Em8MMPP8g333wTzIDNpyNGjHBlwBDrVvBIvATSYczgqxdcCH744Yc6JnhMwv/Hjx9vuSoeL0+eF0qAzxfeESRAAnYQoNJtB0Wby8Cn5cwur1D8M888I/G637K5eq4rDlyMXwMee+wxqVSpkuvqygo5Q8DPYwYuNhGBE/s94FIQUT9ffPFFPSIuIshSnCXA54uzfFk6CaQTASrdLu1tLcKcaBH3grVD+PUJEya4tLaprdbnn38uv/76a7AScA+YOcBIamvHqyeLgN/GzMGDB+Whhx7SzaRmzJihB8l55513dMUbL5kFChRIFtq0vg6fL2nd/Ww8CdhKgH66DTjLlCmjB7nJEC3Mta3Aoy0M5hGIapnZVhMeCyhmAkuXLpWrrroqeGDIkCERo4aaS2FKPATcMl5Qdz+NGUSj1cKVCyLTwkMLngNY1bbaXBlP3/Gc6Ajw+RIdJ+YiARKITCALAsVHzsYcJGAPAXhdGDx4cLAwRPUsWbKkPYWzFBLwAQEEyMI4OX36tB51EvbqCJoTSeClp06dOoKIjLHI9OnTZezYscFTbrrpJmnbtm0sRbg6L7y85M2bN1jHu+66S0aNGuXqOrNyJEAC/iRApduf/erKViEEfIMGDWTRokXB+sEk4PXXX3dlfVkpEkg2gS+//FJatWoV92V/+eUXXfGm/I8AFOx77rknmHDRRRfJzJkzBT78KSRAAiSQTAI0L0km7TS8FlbRxo0bpwf6WLVqlRij6GFVD7bqlStXlipVqsjzzz+fhpTYZBL4L4Hdu3cnhCJLliwJne+Xk7t27Sowx4N5zpIlS0KatX37drnyyiv1Zw4U70cffVSqVq3ql6azHSRAAi4mQKXbxZ3jh6rBHjJSVE1MgvjbvHkzlW4/dDrbEDcBRJZMRGjz/V96Y8aMEWxEtRKY7iDoGP4QsZZKtxUpppMACdhJgOYldtJkWSRAAiRAAiRAAiRAAiSgIECXgQooTCIBEiABEiABEiABEiABOwlQ6baTJssiARIgARIgARIgARIgAQUBKt0KKEwiARIgARIgARIgARIgATsJUOm2kybLIgESIAESIAESIAESIAEFASrdCihMIgESIAESIAESIAESIAE7CVDptpMmyyIBEiABEiABEiABEiABBQEq3QooTCIBrxIIBALy77//erX6rDcJpAWBM2fOpEU72UgSIIFQAgyOwzuCBDxC4MiRI3p0vXXr1ul/iLb3559/CtKPHj2q/3vo0CG9NQUKFJC8efPK2WefLfny5ZMSJUpI6dKl5dJLL9X/KlasqOehkAAJ2Efg1KlTgoBga9eu1cfo+vXrZdOmTXLgwAF9jB47dkz27dsnULoxLvGHMYqxivD0GKNlypTRxyiiZiKNQgIk4B8CDI7jn75kS3xGABH1Zs2aJbNnz5Y5c+bIwoULBZH07JBs2bLpYbDr1Kkj9evX1/8KFixoR9EsgwTShsA///wjc+fO1cfoL7/8IgsWLAgbCTNWMOXKlZNatWpJvXr15Nprr5WSJUvGWgTzkwAJuIgAlW4XdQarQgJYDZs0aZKMGzdOZsyYISdOnEgKFIQPb9y4sbRt21ZatWol+fPnT8p1eRES8BoBrFJjbGKMfvPNN7Jnz56kNaF69erSpk0bfZwWL148adflhUiABOwhQKXbHo4shQQSIjBv3jx58803Zdq0abaulMVTKXzyvv7666Vr165yzTXXxFMEzyEB3xGAmcjQoUPliy++kG3btqW0fVmzZtW/Tt1///26Ao4vVxQSIAH3E6DS7f4+Yg19SgCbHrFSNmjQIPnpp59c2UqYnzz++OPSokULwURPIYF0I7B48WIZOHCgfP7557aZd9nJEPbfDz/8sHTq1Eny5MljZ9EsiwRIwGYCVLptBsriSCAaAl9//bX06dNH/vjjj2iyK/MUKVJEt/EsXLhwcMMkNmVlyZJF/v77b/0P5ir4/I1Vuh07dijLiSaxfPny8vzzz8utt94aTXbmIQHPE1i2bJk88cQT+otxvHLOOefoY7RYsWL6ZsmMzc05cuTQN1VmjFFsrsSm6M2bN8ftfejCCy+URx99VP9D+RQSIAH3EaDS7b4+YY18TADeDLByPHXq1JhaCftNbKiqW7euVKtWTfduEOvGx/379+seFRYtWiQ///yzwKQFE30sct1118mQIUPkiiuuiOU05iUBzxDABubnnntORowYISdPnoy63ueff77UqFFD35yMsXrZZZfp3kfwEhytQBHHMwIKP8YoNlAvX7482tP1fHhBxtezG264IabzmJkESMB5AlS6nWfMK5CAviGyX79+8sYbb+irz9FIlSpVpHXr1rppB7wYOCGY4CdPniyfffaZ/P7771FdImfOnNKlSxd54YUX9BV2Cgn4hcAHH3wgzz77rGzfvj2qJpUqVUofnxin2OTohG317t27Zfr06foYxQbOaF8EWrZsqb8gw10ohQRIwB0EqHS7ox9YCx8TWLVqldx55536CnMkwSfiu+66S9q3b6+vWCVT1qxZI59++ql8+OGHsnXr1oiXRv0++eQTqVSpUsS8zEACbiaAr0DYlDhx4sSI1cSLJjYvduzYUd/MGMtKdsTCI2SAqRhsy997772oTNNgejZs2DC57bbbIpTMwyRAAskgQKU7GZR5jbQlgJWz7t27R/RIAnMReAu57777Ur4ZCr6HR40apa/Kr1y5MmzfQQF55ZVX9I1cFBLwIgH417777rv1YFPh5IILLtDzwWa6aNGi4bI6fgybsLEvBGYk8OUfSR566CF57bXXJHfu3JGy8jgJkICDBKh0OwiXRacvAZiTQIEeM2ZMWAiw1e7bt6++agZf2W4ShJOHL+JnnnlGNm7cGLZq8O390Ucf0dwkLCUedBuB/v376xuawwWdggvNbt26Sc+ePV3pvx4vDajbr7/+GhYvgmFhlRxRLykkQAKpIUClOzXceVUfE8BGLNhThnMDmGEXDYXb7YFoYIP+0ksvRbRHv/rqq3X7cKwIUkjAzQTwQomvM2+99VbYasJee/DgwQLbbTcLVr7ff/99/QU+nD06XvIRfAv7RSgkQALJJ0ClO/nMeUUfE8CE16xZM4FvXyuBhwOYnSTbZtuqPtGmw/MJfAHDq4KVwKsJPLO4XUmxqj/T/U8A5lPYYzFhwgTLxl588cXy9ttvy0033WSZx40H8MIP70jYl2ElhQoV0vduIAIthQRIILkEGO0iubx5NR8TWL16tR7BMZzCDXtQKK1eU7jRbbA7//HHH+Wpp56y9NIAG/AGDRrIkiVLfNzTbJpXCRw5ckRXpMMp3DgOTz5eU7jRJ/ALjhd6mLVBuVbJ3r17pXnz5jJ+/HjVYaaRAAk4SIAr3Q7CZdHpQwDePqBsWm3GgleSd955R5o2beoLKDNnzpR7771XtmzZomwPgoH88MMPuqJOIQE3EMAK98033yy4d1UCky+4wYR9dDI9kqjqYkca3IHCC5KVK1C0FyHt/fJMsoMZyyABpwlQ6XaaMMv3PQG4G4PCvXTpUmVboXjC5KJs2bLK415NRGAdmNJYBe9Ae2HXjsiZFBJIJQHYcN9xxx26r2uVYIUY7i+hlPtJjh8/rrs3tArGhXbDC0rt2rX91Gy2hQRcS4DmJa7tGlbMCwQwqWGzlZXCXbVqVV3x9JvCjb655JJLdHMTROBTCfx+Qyk/fPiw6jDTSCBpBB555BFLhRtfoaZNm+Y7hRtwzzrrLPnyyy/1r1IqgQ04fHhHcg2qOpdpJEACsROg0h07M55BAkECHTp0sNxYeO211+omFpjU/SoIRf/dd99Z2r8uWLBAX2nDSiOFBFJBAL6shw8frrw03OfB3ASed/wqiJIJzya9e/dWNnHnzp1yyy23CGy9KSRAAs4SoNLtLF+W7mMCCB4Dm0iVICT0lClTXO8OUFX3WNPy5Mmjb0yrV6+e8lSEsH755ZeVx5hIAk4SgO9q+JlXCV6GYXZRrlw51WHfpb366qt6AC5t939BAAAgAElEQVSVYC+K1Wq4Kj/TSIAE4iNAm+74uPGsNCcADyVQMuHD2iiYxGF2kW62zLBtb9iwodJzCQL/gEndunWNuPibBBwhcOjQIcHLL1xdGgW2zN98843UqlXLeMjXv/HFqV27dpaeS+CTHC4HKSRAAs4QoNLtDFeW6mMCf//9t9SsWVNpBwmvHVAuy5Qp42MC1k0L58UFn/LhSeG8886zLoBHSMAmAm3atNEjMBoFXjsmTpzoSxtuY1tVv0+ePKm3fcaMGabD+GqFPSh4WaGQAAnYT4BKt/1MWaLPCXTp0kUZyQ62k99++600atQoLgJYNT9w4IBgcxP+sFIHRdVrn7/xSR/eXE6cOGHigKAkH3/8sSmdCSRgJwF4IsF+C5W8+OKL8vTTT6sORZXmh3H6119/CYJ0bdq0ydRmxBDAl7wcOXKYjjGBBEggMQJUuhPjx7PTjAAmI6wCnTlzxtRyTOSY0KORbdu2SevWrXXPHlCu9+3bp1RSEU4eq3JekwEDBlhu3Jo9e7al/bfX2sn6uo8AAuBUqFBBNm/ebKrcddddp3sqyZo1uu1Mfh6ns2bN0qNSnj592sSpf//+0qtXL1M6E0iABBIjEN2TJ7Fr8GwS8A2Bbt26KRXu+vXry/PPPx91O+FqECvCcNWF0PGqVeGoC3NhRgQYsYro99hjjykZurAZrJIHCWAcqhRumH6NGjUqaoUbTffzOEX0XKsVf7w047lEIQESsJcAlW57ebI0HxOAWQRCuBslf/78Mnr0aMvQ6Mb8+F24cGEZOHCgwH9wlSpVVFk8nYaIfnBTdsEFF5jasXDhQhkxYoQpnQkkkCiBVatWWboHhLehokWLxnQJv4/TZ599VukuEV/erFwMxgSQmUmABEIJBCieIKDZ+AY0G8VAvnz5AloPuvZPU0D1eqK+fhJt81GgVKlSSu7aylrCTX3zzTeVZWvmJQmXncoChgwZomyX5q4toG1ITWXVbL82x6jtSGMuEONF9XzUvrrEXJbqBD+OU+2LW0Azt1Fy0/zsqzAwjQRIIE4CEud5PC3JBKDIqiYTt6ahvn4SbdVWyV+LNBnQPkHb0lQtsqPpGl5Xuk+dOhWoVKmSqV24b6GQ+0k4RlPbm5qpllJ51DxyBFavXm1b5fw4TjUf3coxqgW2so0bCyIBEggEaF7ikU8fkyZN8khN/1tNr9U3HFztQSGvv/66MgsCTuTOnVt5LNZEP/qwhn9u+P5VybBhw5SbuFR5vZDmtXvea/WNdA/AXEsV+RTehrSX40inR33cj+MUwatUpmAI/rV+/fqo2TAjCZBAeAJUusPzcc1R7Mj3knitvuHYTp48WZYtW2bKUq1aNWnRooUpPd4EvwbTQcAcuBA0CqLgffrpp8Zkz/722j3vtfqGuzHgZWT8+PGmLAiCY7cXDj+OU9iuqyJSwrOJ1UuzCTYTSIAEIhKg0h0RETOkOwFswFJJ9+7dVclMUxDo0aOHIlVEs5FVpjORBGIhMHz4cDl27JjplI4dO0rBggVN6UwwE4BnJm3PkOnAmDFjBNFmKSRAAokToNKdOEOW4GMCW7ZsEfizNQo+V8PPNiU6AnAfqPLSom3UkhUrVkRXCHORgIIAzL8mTJhgOoLIk3BPSYmOAFbwESLeKPgiAjMTCgmQQOIEqHQnzpAl+JjAuHHjlHainTt3jslFoI8RRd20hx9+WJl37NixynQmkkA0BObMmaO0O27VqpVccskl0RTBPP9PwOolRWW6Q2gkQAKxE6DSHTsznpFGBD777DNTa7GCdvvtt5vSmRCewG233SbwaW4UrqIZifB3LASsXtrat28fSzHMqxHAF7zatWubWPz0008MlmOiwgQSiJ0Ale7YmfGMNCGguRkTBHIxCkInq3b6G/PxdyiBvHnzyo033mjCAs6///67KZ0JJBCJwJkzZwQbnY2i+YGX66+/3pjM31EQUJnNgbNqASKK4piFBEggEwEq3bwdSMCCwHfffac8ovmuVaYnM1Hzfy1r166VmTNnytKlSwW/vSBWXwisWHuhTaxj6gj88ccfyhXYZs2aSY4cOVJXsf+/shfHKZ5v2bJlM7HDs4ZCAiSQGAEq3Ynx49k+JvDLL7+YWge/03a6CTRdIEzCiRMnZOTIkVK1alXRAn7on4Kx6l6xYkXdbAMuDKdNmxamhNQfwkq3ysQEdrkUEoiVgGqTM8qAPXeqxOvjtGjRoqIFADLhmz9/vnJ/iykjE0iABCwJUOm2RMMD6U5g3rx5JgRQeFVKoymjzQlQLq644gp58MEHZdGiRaagMpjoYQrTtGlTcbMrw1y5ckmNGjVMdDChwycwhQRiIaB6MUawKpXSGEu58eb1yzitV6+eCcGePXtk8eLFpnQmkAAJRE+ASnf0rJgzjQisWrVKEHDDKKpNRsY8dv+Gn3CsaG/atCli0YjI99prr7naxZdKIdq3b5/Sfj5ig5khbQnAVeBvv/1maj9ejM8++2xTutMJfhqn11xzjRLX7NmzlelMJAESiI5A9uiyMRcJpBcBrLyqxGoyUuW1I+3LL78U/EFgZ9m8eXO5+uqrdVdoUMJHjBihVMb79esnLVu2lKxZ3fdebcUQzGvWrGkHNpaRBgQQ0XTHjh2mlqpe6kyZbE7w2zjF4gK8NJ08eTKEFPzqU0iABOInQKU7fnY808cE1q1bp2ydyjRCmdHmxCZNmsiQIUOkfPnyISXfddddukmJcTLE5kq4+UIIdreJFcP169e7raqsj4sJuG2MApVfxim+FFSoUMH09Wnjxo0uviNYNRJwPwH3LYO5nxlrmAYEsIpmlEKFCgk2GSVbsCns66+/NincqEfhwoVl6NChyiq5VYnFhK4KWuLW+irhMjHlBKyU7ksvvTQldfPbOC1VqpSJYzQmbqaTmEACJBAkQKWbNwMJKAiolO4SJUoocjqbVKZMGfnoo4/Cuj/Dp+BatWqZKuLmCbJkyZKeqq+pskxIOQHVSxrMqVKhdPtxnJYuXdrUx7t375a9e/ea0plAAiQQHQEq3dFxYq40I7B582ZTi1WTkCmTzQn4xBvNpjBV3bZu3WpzbewrTlVfKFHYCEohgWgIqEwd8AXlrLPOiuZ0W/P4cZxavbyoFiRshcnCSMDHBKh0+7hz2bT4CMArgmo1B1Hu3CoXX3yxqWrGTVCmDClMuOiii0xXR33//vtvUzoTSEBF4NChQ6bkVJh/mSoRJsFL47RYsWLKlhw4cECZzkQSIIHIBLiRMjIj5oiTgMrXa5xFJfU0rLaqVlwRxtyt4oboe7GwsWJ53XXXhTWlieUazBuZgFfHKFqGiKxGiearkPGcZP720jjNly+fEg1fjJVYmEgCURGg0h0VJmaKh4AqcEU85bjlHKtJyC3181I9rFiq/C57qV1eq6vfxqjblW4v3R9WL8ZUur3Ui6yr2wjQvMRtPcL6uJaA1STk2gq7uGJk6eLO8XDVeF/Z13lWLI8cOWLfRVgSCaQZASrdadbhbG78BNwYaCb+1qT2TLJMLX+/Xp33lX09a8VSZXpn31VZEgn4mwCVbn/3L1tnIwF+VrUPJlnax5Il/Y/A0aNHicMmAlZj1GoF3KbLshgS8DUB2nT7untT27i6deumtgJxXv3MmTMyb94809lWk5ApIxMiErBiiTDwXtpslrmhXrSP9uoYBfc1a9aYvAxR6Y449KLOYDVGqXRHjZAZScBEgEq3CQkT7CLw888/21VUUsuB0p09u3loWE1CSa2cTy5mxXL69OlyzjnneLKVWbJk8Vy9vTpGAbpOnTompdvqvvJcx7igwlYsqXS7oHNYBc8SoHmJZ7uOFXeKQLZs2ZSKn8p3t1N18Hu5KpawIeWE7veet699Kg84+/bts+8CaV7Snj17lATy58+vTGciCZBAZAJUuiMzYo40JKAKYqGKgJeGaGxpsiqqHaIJqr4w2HJBFuI7Aqoxiqimp0+f9l1bU9GgdevWKS+LcUohARKIjwCV7vi48SyfEyhVqpSphVS6TUjiTlCxLFmyZNzl8cT0I1CmTBlToxHVdNOmTaZ0JsROAC8wRsEqd/HixY3J/E0CJBAlASrdUYJitvQiULp0aVODt2/fLqrQ06aMTAhL4NSpU6Ka0FXMwxbEg2lNQKV0A4jVCm1aw4qj8aoXYyxGeHHvQhzN5ykk4AgBKt2OYGWhXidw6aWXKpuwePFiZbodiaqgE7t27Yqq6MOHD5vy/fXXX6a0cAm41rhx42TWrFnhsiV8bNmyZUoTACslKuELsgBfErAao3/88Yej7U3lOMUm77Vr18rUqVPlq6++Eowlqw2PiUCAic7q1atNRai+AJoyMYEESMCSAJVuSzQ8kM4EKlasqGy+UwppIBBQKrsLFy4U/IUTBKuYO3euKQteEFQryqaMWsKkSZOkWrVqcscdd8iQIUNUWWxLs2Joxdy2C7MgXxEoW7asqDb1Oem6MVXjdNWqVdK6dWspUKCAoN233HKLNGvWTK666irBhlJ4cpkyZYpt/YtnjmpTaoUKFWy7BgsigXQkYPaLlo4U2GYSMBCAAnruuefKgQMHQo7MmTPHVlZw2bZ582YZO3aszJw501Q2bFQbNmwod999tzRo0EBq164tF1xwgRw7dkzmz5+vn/vJJ5/Ib7/9Zjr34MGDUq9ePbnvvvv0Sfmaa66Rs846S88HxRcrggsWLBAo5ytWrAienydPHlNZdiaolKKcOXPqdaSQQLQEcM9Ur17dNG5wT2NFGF6I7JJUjVPUv3///tKnTx/96xDGPpRtKL8wdcOKNxRyvHQ3b95cV8YnTpyYcNtnz56tRFe/fn1lOhNJgASiJKC9uVM8QEDrzoDX/jyANWwVr7/+ehNzzYd0QFOEw54Xy8FY+3TkyJF68ZqSbapbpLI0JVs/V5usw5577733xtKEmPJqq/KBCy+80HR97WUipnLcmDkSfzcedyPHWOr07LPPmu4lcMb4sFNi7Ts7xinqr71QB9unrXAHtIBAIc36559/AnfeeWcIg27duiXcdE2xN3HVXsYD2st+wmWzABJIZwI0L9GephQSUBFQRevD6vGMGTNU2ZOaVrBgQYFf62gFeTNWuXPlyiUDBgwI/r3yyishxWAF0SnBityOHTtMxXOV24SECVEQwNcblWAF2A2SyDhF/fv27RtsBsyvLrvsspBmYawOHz5cChcuHEx/++239S9h8Qqieqq+RlWtWjX4DIm3bJ5HAulOgOYl6X4HsP2WBGDOoRKYgtx4442qQzGnaW/8MZ+DE7ChCZ/Q4xEo3T179gyeCpvwJ598MvjbSV/ZYKcSK9aqvEwjgQwCtWrV0u26jRuJv/jiC3nhhRdsA5WKcQovLJn3ZFjtz0D7y5UrJ7t379bbC5M0mJ5ZvZBEgjJ58mSTWR3Oibe8SNfjcRJIJwLRL5WlExW2lQQ0ArCfVu3WR6jy48eP+5aRnbawmSHhJQETulGKFi0qjRs3NibzNwlEJICvNzfccIMpH+ycf//9d1O6lxKwQTLz16xwXkqMG0q3bt0ad1PhwUgl2MhJIQESSIwAle7E+PFsHxOAP9qWLVuaWogQ5nZ6CjBdwKcJ3333nWzbts3UOmwMy5EjhymdCSQQDYG2bdsqs3366afKdK8kFilSRDR7bV3xxotp9+7dLatudC0ar897uBn9/vvvTdepVKmS7imFQgIkkBgBKt2J8ePZPifQrl07ZQthR0mJjcCwYcOUJ8BNIYUE4iVw88036149jAJTJqPZiTGP23+PHj1af1HdsmWLPPDAA8rq7ty5U1auXBk8Bu9D5cuXV+aNlAh78BMnTpiycZXbhIQJJBAXASrdcWHjSelCoEqVKnLllVeamgsXYqrNRqaMTNAJLFmyRL755hsTDZjv0FbUhIUJMRDAHoWmTZuaztizZ4+MGDHClO61BKxyW+2zgK15jx49BJsfMwT7M4zmJtG0GSZzmtcVU1astN9+++2mdCaQAAnEToBKd+zMeEaaEXjwwQeVLR44cKAynYlmAlasOnXqxLDSZlxMiZFAly5dlGdg5RYbC/0oUJIxfjKb0bRp00aeeOKJuJr74YcfKs2/8CVBtbclrovwJBJIcwJUuj1yA2BTjZfEa/UNxxYT20UXXWTKgjDMToecNl3UgwnwwvD555+bal6oUCHp3LmzKd2rCV67571W33D3Bb5IaX71TVn+/PNP+eCDD0zpXk/AnhK4EISiDIHLQPx//Pjxlqvi4dqMF5OhQ4cqs2T2dKTMwEQSIIGoCVDpjhpVajO2aNEitRWI8epeq2+45sFDgsqeEq72HnvssXCn8phGABvAVKuNHTt2FC3YkG8Yee2e91p9I90oMLNQyYsvvijwr+8HQXj2Jk2a6NEn8TJbvHhxQfu0oDl61Np4ZdCgQbJ27VrT6Yhoiz8KCZCATQTSOTKQl9quTRqBDh06BDRbPVOkMO1WcE0a6od6or5+Em1Xf0ALC6/kPGbMGE83VXPlZ3tEuwwgWpASJTNEt9Pcmnmam7HyHKNGIsn/XaNGDeX91rVr1+RXxsYrHjhwIPCf//wnoLnz1NunBckJvPPOOwFt02PCV9E2aVo+2yZNmpRw+SyABEjgfwSy4L826e8shgR8TUALOa0MuFGyZElZtmyZnH322Z5sP1bsM/vm1sJIy+uvv55wW7QQ1VK5cmWBz2SjPProozJkyBBjMn+TQEIEvv32W6XfbmxEXLBggW6S4TWZPXu23HvvvbJhwwaBK0DYbGNV22pzZaztg/cglW9uRInFhnG4TqWQAAnYQ4BKtz0cWUoaEMDGJfiqVUWGu//++5U7/72ABZ4P8ubNG6zqXXfdJaNGjUq46jAree2110zl4JP48uXL4/KwYCqMCSRgINCqVSv58ssvTVyqV6+uexxC6HSvCOysYTZz+vRpPerkyy+/LNHY4sPjCJRmeHYJJ4jcedttt5my4CV83rx5AmYUEiABGwlw2Z8ESCB6AhMmTFB+vtaGZEBbLYq+IBfl1DZghbRJ2zQaWL16dUI1/PrrrwPaxK9kpW1sS6hsnkwC4Qhs3LgxoCmmyntP+4oT7lRXHZs4caKyDXjWRPOnvWCEbc+mTZsC2gZMZVnaIkLYc3mQBEggPgLcSGnjCwyL8j+BW2+9VeklAS1/5JFHRJvwPQFBs3EVtAWR5u65556QOm/fvl33Ta7Zx4pmny/YvBWL4HxsPIXZilGw+pbIhi9jefxNAkYCMPey2uCMlWOvRJPdvXu3sWkx/Q5nFoKVc4xt1TUQCfOll16K6VrMTAIkEB0BKt3RcWIuEggSQDRKVQQ8BOOAfWTmQBVuxaZt/hRtJU0PWqMSTMrz58+XTz75RGlOozoHabDjbt++vUDxNgoCdmibv2gjagTD37YTQICYqlWrKsvVNiTqnj/cLogsmYiEs/mGyYpVcC/41Ic7TwoJkID9BGjTbT9TlpgGBOAP1ypK20033STarn/JkSNHGpD4XxOxsg0mKp/cyIVod7B9p5BAMghoJlJSu3Zt0Tx/mC6nef+Qn376SRDtMd0ESnWvXr2UzcZXLz/6NVc2lokkkAICXOlOAXRe0vsE2rZta6lAItw5AupoFl/eb2gMLXj44YctFW4o41S4Y4DJrAkTwMbDwYMHK8uBT+pmzZrJ4cOHlcf9mvjRRx9ZRqyESdmbb77p16azXSTgCgJc6XZFN7ASXiQAbyZYSbOKSmmX6z0vsOnTp4+lHSiUn99++43eSrzQkT6sI2yXYSalkoYNG+o23l5196lqk1Xa5MmT9S9Rmm9vUxZ4RIF7QC+6VDQ1hgkk4GICXOl2ceewau4mgEiVsIsuUaKEsqLYtIVNg7CP9qvApASbMq02Xl144YU6I9hzU0ggFQTeffddqV+/vvLSP/zwgzRu3FiwH8PPApORNm3aKBVuuAeEi1Aq3H6+A9g2txCg0u2WnmA9PEkAnhKwgqTaWIkGjR49Wg/ZfOzYMU+2L1ylsWkSK2fYWKoShHiHH+DLL79cdZhpJJAUArlz59bHKDz1qOTXX3+VBg0aeMbzkKoN4dLg2xvmbidPnlRmGzZsmMC3OYUESMB5AlS6nWfMK/icAFaIsLHS6hM1bLwbNWokmzdv9g2JnTt36pH/rDZNIgAJPKRcffXVvmkzG+JdAngBnDp1qh7RUSUrV67UFW8rjx6qc9yehpdieGp5+umnLav63HPP6XkoJEACySFApTs5nHkVnxO49tprdbtRK8Ubq2lQQGFq4XWZNm2a7sMb3h9UAoUbn7PhxYVCAm4hUKxYMV3xvuSSS5RV2rJli654v/jii0of88qTXJoIzy3wiQ8XnVaCPSd9+/a1Osx0EiABBwhQ6XYAKotMTwItWrTQJ3UrU5Ndu3bpAWm6dOmitK10OzV8nu7Zs6c0bdpUtm3bpqwuVhTxYgFf3RQScBsBmDr9+OOPUr58eWXVsP/imWee0QNgqXzNK09yWaIWYVbf4B0uqBVeLF5//XWX1ZzVIQH/E6D3Ev/3MVuYZALwZgIFPJw5CfwEv/rqq9KyZcsk1y6+y2F1GwE18BneSrBpEjbcNCmxIsR0txD466+/9L0Wc+fOtawSXp7hzxqRZr3gc3/FihV6JM7vv//esk0ImDNixAjdxptCAiSQfAJUupPPnFdMAwKbNm3SJ/Vly5aFbS3soocMGSJwq+dG2bBhg65sI9hPOClbtqyex63tCFd3HktPAtjcjAiykcLCV6hQQff33aRJE1eCOnTokG4m8tZbb1lulkTFzz//fMEqOPyTU0iABFJDgOYlqeHOq/qcALyazJs3T3cZGE6mT58umNTbtWsnixcvDpc1qcewaobodAiYEUnhRqAg+OGmwp3ULuLFEiSAMOu4twcMGCDwcGIleHG+7rrrdHvvr7/+2ipb0tN3796tb5LEuIOpiJV3ElSsevXq+qo+Fe6kdxMvSAIhBLjSzRuCBBwmgA2Wjz/+uOzduzfilW688UZBZEdM8vCfm0yBz23Yu77xxhvy1VdfRdxMBt/bCCn9wAMPJLOavBYJ2E4AL4133XWXrFmzJmLZlStX1k1OWrdubblxOmIhCWRYunSpvP3227p3oCNHjkQsCRsm8WKBDc4UEiCB1BKg0p1a/rx6mhBYt26dHgZ91qxZUbUYnhZgFw4/2NgUlSVLlqjOiyfT77//LmPHjtVX/f7888+oiqhVq5aMHDlSXwmnkIAfCCAkPBRUhErHC2gkwaZhvCTjSw/+dVKp3bhxoz5GJ0yYYBkB11hfuEeE6RpXt41k+JsEUkeASnfq2PPKaUgAq1MImR6tcgtExYsX1zcn1qtXT4+sB3OUrFnjswwLBAL6Zkgo//BJjE/O4TZ8GrsILwOwH7333nsdfREwXpe/SSBZBDAmsCERL6PRCuylYcJRt25dfYzCpWauXLmiPd2UD+4LZ8+erYdmR32WL19uymOVALeleHmA6QlMaCgkQALuIUCl2z19wZqkCYG///5bXnjhBT2S49GjR2NuNSZVrGLBbhz/wmtI3rx5g39YFcc1Mv4QyAYbIrG5E/9G80naWCnYvD744IPy/PPPS4ECBYyH+ZsEfEUAK93vvfee9OvXLy7XgfASUqpUKf0PYxQvzvny5dPHKP6FNxSMfYxFjNN9+/bpYxMr2hin8Yalv+WWW/RNn2XKlPFVf7AxJOAXAlS6/dKTbIfnCEAZxgaoUaNGxT3JOt1orOB16NBBX/m7+OKLnb4cyycBVxGAhxMo3wiVDhMxNwoUfPj/h5ehatWqubGKrBMJkMD/E6DSzVuBBFJMALak8J0LG2msdrlBSpQoofvyRSCf8847zw1VYh1IIGUEEDRn/PjxMnToUJk/f37K6pH5wueee65uT969e3eubLuiR1gJEohMgEp3ZEbMQQJJIQB7a9hajxs3To9suWPHjqRcN+MihQsXlptvvlnfvNmwYcOke09JamN5MRKIkwDcaX766ad65FWEW0+mwEYb/sKhbCMOAG22k0mf1yKBxAlQ6U6cIUsgAdsJnDp1So8sN3PmTH0j1YIFCwSrbXYKXBLC/VmdOnV0JRuhrxPZ/GVn3VgWCXiBAFwNwtf+nDlz9BXwgwcP2l5t+OGGByNs0IQnEn55sh0xCySBpBGg0p001LwQCcRPAJut4G1k0aJFsn79+uDGyK1bt0ZV6EUXXRTc2IVNVlC24WmBmyKjwsdMJBCRAF6UoXhDEYf9NzZFZvydOXMm4vmFChWSSy65RN94ib/y5cvrijbGLoUESMAfBKh0+6Mf2Yo0JYCNXlhdw6dmrIZnFrgwg+9tKNbweEIhARJIPgFEijxw4IC+Sm20B8fGR5ipINAUX4CT3ze8Igkkm0D2ZF+Q1yMBErCPAGw68acKYw1TEbgTpJAACaSOAILmYL+EynQL4xbuBCkkQALpQSC+CBvpwYatJAESIAESIAESIAESIAFbCFDptgUjCyEBEiABEiABEiABEiABawJUuq3Z8AgJkAAJkAAJkAAJkAAJ2EKASrctGFkICZAACZAACZAACZAACVgToNJtzYZHSIAESIAESIAESIAESMAWAlS6bcHIQkiABEiABEiABEiABEjAmgCVbms2PEICJEACJEACJEACJEACthCg0m0LRhZCAiRAAiRAAiRAAiRAAtYEqHRbs+EREiABEiABEiABEiABErCFAJVuWzCyEBIgARIgARIgARIgARKwJkCl25oNj5AACZAACZAACZAACZCALQSodNuCkYWQAAmQAAmQAAmQAAmQgDUBKt3WbHiEBEiABEiABEiABEiABGwhQKXbFowshARIgARIgARIgARIgASsCVDptmbDIyRAAiRAAiRAAiRAAiRgCwEq3bZgZCEkQAIkQAIkQAIkQAIkYE2ASrc1Gx4hARIgARIgARIgARIgAVsIUOm2BSMLIQESIAESIAESIAESIP/mGK0AACAASURBVAFrAlS6rdnwCAmQAAmQAAmQAAmQAAnYQoBKty0YWQgJkAAJkAAJkAAJkAAJWBOg0m3NhkdIgARIgARIgARIgARIwBYCVLptwchCSIAESIAESIAESIAESMCaAJVuazY8QgIkQAIkQAIkQAIkQAK2EKDSbQtGFkICJEACJEACJEACJEAC1gSodFuz4RESIAESIAESIAESIAESsIUAlW5bMLIQEiABEiABEiABEiABErAmQKXbmg2PkAAJkAAJkAAJkAAJkIAtBKh024KRhZAACZAACZAACZAACZCANQEq3dZseIQESIAESIAESIAESIAEbCFApdsWjCyEBEiABEiABEiABEiABKwJUOm2ZsMjJEACJEACJEACJEACJGALASrdtmBkISRAAiRAAiRAAiRAAiRgTYBKtzUbHiEBEiABEiABEiABEiABWwhQ6bYFIwshARIgARIgARIgARIgAWsCVLqt2fAICZAACZAACZAACZAACdhCgEq3LRhZCAmQAAmQAAmQAAmQAAlYE6DSbc2GR0iABEiABEiABEiABEjAFgJUum3ByEJIgARIgARIgARIgARIwJoAlW5rNjxCAiRAAiRAAiRAAiRAArYQoNJtC0YWQgIkQAIkQAIkQAIkQALWBKh0W7PhERIgARIgARIgARIgARKwhQCVblswuruQb7/9VqpWrRr8GzJkiLsrzNqRAAmQAAmQAAlEJMD5PSIiV2XI7qrasDKOEFixYoUsWrQoWHajRo0cuc7Ro0flwIEDcvDgQf3v0KFDUrp0aSlXrpwj12OhJEACJEACJJDOBDi/e6v3fal0//vvv7rylyE5c+aUfPnyeatnXF7b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)
*This image is from Jessica Stringham's [page](https://jessicastringham.net/2019/01/09/sum-product-message-passing)*

Factors, such as $$p(h_1)$$, are represented by black squares and represent a factor (or function, such as a probability distribution.) Variables, such as $$h_1$$, are represented by white circles. Variables only neighbor factors, and factors only neighbor variables.

In code, 
 - There are two classes in the graph: Variable and Factor. Both classes have a string representing the name and a list of neighbors.
 - A Variable can only have Factors in its list of neighbors. A Factor can only have Variables.
 - To represent the probability distribution, Factors also have a field for data.
 - A source of message passing's efficiency is that messages from one computation can be reused by other computations. Thus we store the message that was last past between Factor and Variable in an edge. We need this to later for the Loopy Belief Propagation algorithm. (this here is a little different from Jessica Stringham's version)


```python
import numpy as np
from collections import namedtuple
```


```python
class Edge(object):
    def __init__(self, neighbor):
        self.message = None;
        self.neighbor = neighbor;

    def __repr__(self):
        return "{classname}\nMessage:\n{message}\nNeighbor:\n{neighbor}".format(
            classname=type(self).__name__,
            message=self.message,
            neighbor=self.neighbor
        )

class Node(object):
    def __init__(self, name):
        self.name = name
        self.edges = []

    def __repr__(self):
        return "{classname}({name}, [{edges}])".format(
            classname=type(self).__name__,
            name=self.name,
            edges=', '.join([e.neighbor.name for e in self.edges])
        )

    def is_valid_neighbor(self, neighbor):
        raise NotImplemented()

    def add_neighbor(self, neighbor):
        raise NotImplemented()

    def init_messages(self, value):
        for edge in self.edges:
            edge.message = value;

class Variable(Node):
    def is_valid_neighbor(self, factor):
        return isinstance(factor, Factor)  # Variables can only neighbor Factors

    def add_neighbor(self, neighbor):
        assert self.is_valid_neighbor(neighbor)
        self.edges.append(Edge(neighbor))
        neighbor.add_neighbor(self) 

class Factor(Node):
    def is_valid_neighbor(self, variable):
        return isinstance(variable, Variable)  # Factors can only neighbor Variables

    def __init__(self, name, data):
        super(Factor, self).__init__(name)
        self.data = data

    def add_neighbor(self, neighbor):
        assert self.is_valid_neighbor(neighbor)
        self.edges.append(Edge(neighbor));


```

### Representing probability distributions as numpy arrays

The sum-product message passing involves representing, summing, and multiplying discrete distributions. 

A discrete conditional distribution $$p(v_1 \mid h_1)$$ can be represented as an array with two axes, such as

| | $$h_1$$ = a | $$h_1$$ = b | $$h_1$$ = c |
|-|-|-|-|
| $$v_1$$ = 0 | 0.4 | 0.8 | 0.9 |
| $$v_1$$ = 1 | 0.6 | 0.2 | 0.1 |


Using an axis for each variable can generalize to more variables. For example, the 5-variable $$p(h_5 \mid h_4, h_3, h_2, h_1)$$ could be represented by an array with five axes. 

It's useful to label axes with variable names using `namedtuple`! (It's kind of like a janky version of the [NamedTensor](http://nlp.seas.harvard.edu/NamedTensor).)


```python
LabeledArray = namedtuple('LabeledArray', [
    'array',
    'axes_labels',
])

def name_to_axis_mapping(labeled_array):
    return {
        name: axis
        for axis, name in enumerate(labeled_array.axes_labels)
    }

def other_axes_from_labeled_axes(labeled_array, axis_label):
    # returns the indexes of the axes that are not axis label
    return tuple(
        axis
        for axis, name in enumerate(labeled_array.axes_labels)
        if name != axis_label
    )
```

### Checking that a numpy array is a valid discrete distribution

It's easy to accidentally swap axes when creating numpy arrays representing distributions. 

To check that a multidimensional array is a _joint_ distribution, the entire array should sum to one.

To check that a 2D array is a _conditional_ distribution, when all of the right-hand-side variables have been assigned, such as $$p(v_1 \mid h_1 = a)$$, the resulting vector represents a distribution. The vector should have the length of the number of states of $$v_1$$ and should sum to one. Computing this in numpy involves summing along the axis corresponding to the $$v_1$$ variable.

To generalize conditional distribution arrays to the multi-dimensional example, again, when all of the right-hand-side variables have been assigned, such as $$p(h_5 \mid h_4=a, h_3=b, h_2=a, h_1=a)$$, the resulting vector represents a distribution. The vector should have a length which is the number of states of $$h_5$$ and should sum to one.


```python
def is_conditional_prob(labeled_array, var_name):
    '''
    labeled_array (LabeledArray)
    variable (str): name of variable, i.e. 'a' in p(a|b)
    '''
    return np.all(np.isclose(np.sum(
        labeled_array.array,
        axis=name_to_axis_mapping(labeled_array)[var_name]
    ), 1.0))
    
def is_joint_prob(labeled_array):
    return np.all(np.isclose(np.sum(labeled_array.array), 1.0))
```


```python
p_v1_given_h1 = LabeledArray(np.array([[0.4, 0.8, 0.9], [0.6, 0.2, 0.1]]), ['v1', 'h1'])

p_h1 = LabeledArray(np.array([0.6, 0.3, 0.1]), ['h1'])

p_v1_given_many = LabeledArray(np.array(
    [[[0.9, 0.2, 0.4], [0.3, 0.2, 0.9]],
     [[0.1, 0.8, 0.6], [0.7, 0.8, 0.1]]]
), ['v1', 'h1', 'h2'])

assert is_conditional_prob(p_v1_given_h1, 'v1')
assert not is_joint_prob(p_v1_given_h1)

assert is_conditional_prob(p_h1, 'h1')
assert is_joint_prob(p_h1)

assert is_conditional_prob(p_v1_given_many, 'v1')
assert not is_joint_prob(p_v1_given_many)
```

### Parsing distributions into graphs

There is a nice little parser in Jessica Stringham's notebook to parse a string like `p(h1)p(h2h1)p(v1h1)p(v2h2)` as a factor graph. I don't want to use this here and define the factor graph later directly in code.

### Adding distributions to the graph

Before we can run the algorithm, we need to associate LabeledArrays with each Factor. 


```python
h1 = Variable('h1');
h2 = Variable('h2');
v1 = Variable('v1');
v2 = Variable('v2');

p_h1 = Factor('p(h1)', LabeledArray(np.array([[0.2], [0.8]]), ['h1']))
p_h2_given_h1 = Factor('p(h2|h1)', LabeledArray(np.array([[0.5, 0.2], [0.5, 0.8]]), ['h2', 'h1']))
p_v1_given_h1 = Factor('p(v1|h1)', LabeledArray(np.array([[0.6, 0.1], [0.4, 0.9]]), ['v1', 'h1']))
p_v2_given_h2 = Factor('p(v2|h1)', LabeledArray(p_v1_given_h1.data.array, ['v2', 'h2']))

assert is_joint_prob(p_h1.data)
assert is_conditional_prob(p_h2_given_h1.data, 'h2')
assert is_conditional_prob(p_v1_given_h1.data, 'v1')
assert is_conditional_prob(p_v2_given_h2.data, 'v2')

h1.add_neighbor(p_h1)
h1.add_neighbor(p_h2_given_h1)
h1.add_neighbor(p_v1_given_h1)

h2.add_neighbor(p_h2_given_h1)
h2.add_neighbor(p_v2_given_h2)

v1.add_neighbor(p_v1_given_h1)
v2.add_neighbor(p_v2_given_h2)

belief_network = [h1, h2, v1, v2, p_h1, p_h2_given_h1, p_v1_given_h1, p_v2_given_h2]
```

## Belief Propagation

Sum-product message passing will compute values ("messages") for every edge in the factor graph.

The algorithm will compute a message from the Factor $$f$$ to the Variable $$x$$, notated as $$\mu_{f \to x}(x)$$. It will also compute the value from Variable $$x$$ to the Factor $$f$$, $$\mu_{x \to f}(x)$$. As is common in graph algorithms, these are defined recursively. 

(I'm using the equations as given in Barber p84.)

### Variable-to-Factor Message

The variable-to-factor message is given by:

$$\mu_{x \to f}(x) = \prod_{g \in \{ne(x) \setminus f\}} \mu_{g \to x}(x)$$

where $$ne(x)$$ are the neighbors of $$x$$.

#### Example

The arrows point in the direction of the message. Please note that messages in all directions have to be computed.

![image.png](data:image/png;base64,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C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQtoeHKujtwIECBAgACBJAIaniSMghAgQIAAAQI5C2h4cq6O3AgQIECAAIEkAhqeJIyCECBAgAABAjkLaHhyro7cCBAgQIAAgSQCGp4kjIIQIECAAAECOQto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)

In this case the variable-to-factor message is given by:

$$\mu_{x_1 \to \psi_3}(x) = \mu_{\psi_1 \to x_1}(x) \mu_{\psi_2 \to x_1}(x)$$

This is the elmentwise product of the two messages. For instance:

$$ \mu_{\psi_1 \to x_1}(x) =
\begin{pmatrix}
a_1 \\
b_1 \\
c_1
\end{pmatrix}
$$
and 
$$ \mu_{\psi_2 \to x_1}(x) =
\begin{pmatrix}
a_2 \\
b_2 \\
c_2
\end{pmatrix}$$
then
$$ \mu_{x_1 \to \psi_3}(x) =
\begin{pmatrix}
a_1 a_2 \\
b_1 b_2 \\
c_1 c_2
\end{pmatrix}$$


### Factor-to-Variable Message

The factor-to-variable message is given by 

$$\mu_{f \to x}(x) = \sum_{\chi_f \setminus x}\phi_f(\chi_f) \prod_{y \in \{ne(f) \setminus x \}} \mu_{y \to f}(y)$$

In the case of probabilities, $$\phi_f(\chi_f)$$ is the probability distribution associated with the factor, and $$\sum_{\chi_f \setminus x}$$ sums over all variables except $$x$$.

Lets illustrate this with two examples.

#### Example 1

![image.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjwAAAFUCAYAAAAgQOYwAAAd10lEQVR4Ae3dbYxcZb0A8P9ul93pznRx11JpIQVjUl6E8LJ4SzACjdImJKhQS3j5QLzGaCBqiYLJNdX4wZqYEF+iJl7JRb0RbhQVKHovxTdQWlcsEUgERCOkSHVbWqh2u91ud26ecXfZbnfb3Z0zc2a2v/NlzpyZ87z8zvOc5z/nbSJMBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAjMT4GWeVitEyPi/IhYHBGFiGiPiKGIGIyIXRHx+4h4bR7WW5UIECBAgMBsBY6bMbPZA57WiHh7RKzs7u6+7NChQ72Dg4OLzzjjjIFly5a1dHZ2thQKhdbBwcGRgYGB8ssvv1x+7rnnOguFwq4FCxZs27NnzyMR0RcRj0XEyGxbie8TmE8CbW1te4eHhxfNpzqlurS1tf1jeHi4a77VS30IzEHguB4zmzXgeWNra+v7Ozs7P75kyZLimjVr2leuXNnR29sbZ555ZtrBTdsOhoeH49lnn41t27ZFX1/fgYceemiov79/38DAwB0jIyP/FRG7p13ZBwTmt0C5XC7Puxq2tFR2c826r5t320OFchEwZubCXl2mvV1dXf9TKBT2X3vttfu2bt1aHhkZSTvpOU9p/S1btpTXrVu3L6Wb0o+IC6srprUJNKXAnPtRI68YEfMvimvK5qXQOQgYM3NArzbLUqlU+mZ3d/e+z3/+88P9/f012b+mdDdu3Dic8imVSv8ZEaVqC259Ak0kUJN+lXeiAp4maoGKmpWAMTMryTqns6pYLP7t+uuvH9i9e3dd9p0pn+uuu26gWCzuiIjL61xf2RHIS6Au/avemQh48mpO8s1JwJiZE3w12RaLxeKdPT09Aw8++GC995GV/DZt2lTu6elJR3u+GRHFaipjXQJNIJBLP6t1pgKeJmh5ipiFgDEzC8Uc0ugplUpPr127tm5Hdabb6aajPakcixYteioienKwkCWBeglM1w2aermAp17NRz45Chgzc8SvJuuTS6XSn2+99dYD1V6QnNVeOpVj/fr1B1K5IuLkaipnXQINLJBVl2modAQ8DdziFC0LAWNmFoo5pJGi1D9/+tOfHmqUYGdsz53Ks2HDhqHRoMeRnhwahyxrLjDW3OfVq4Cn5u1GBvkJGDPzs68q5+KiRYuebqQjO5P3+mNHekZPb7mmp6rNbeUGFJjc5OfFewFPA7Y0RcpCwJiZhWIeaaQLg9O1Mo12ZGfyHj+VL5Vz9Lb1PKjkSaBWApOb+7x4L+CpVXORbp4Cxsw89avLe1W6G6pet51XuxdP5Uzldct6dRvd2g0nUG3XaMj1BTwN184UqHoBY2b1hrmkUErP2cnr1vO57qHTLeujz+lxaiuXZiPTGgjMtTs09HoCnhq0FEnmKWDMzFO/mrzTYbn0UMGG3mNOU7j0cEKntqrZ+tZtMIFpWnpzLxbwNFgrU5yqBIyZVfHlunJv+huHZjmVNXm3n8qdyu+/t3JtQzLPTmByE58X7wU82TUQKeUuYMysYhOkv4rPberq6rrt9ttv7+ju7s6tDNVknMp92223daR6VJOOdQkQIECAwLEEjJnHEjr65y1H/7imn76xUCi8tH379sLixYtrmlEtE9+5c2csX758cHBw8JSI2F3LvKRNoMYC6YhOjbOof/ItLZXdXJ77uvpXWo7zUcCYWeVWze0IT1tb27+/+93vHmnmYCfZn3TSSXHVVVeNtLa2vr/KbWF1AgQIECAwpYAxc0qWpljYWiqVdmzdunVeXCOwZcuWcqlUejkicgsgm2KrK2SjC8yL/ji5Eq7hafRmp3wzEDBmzgDpWF/Ja4B++5IlS4orV648VvmO+vmnPvWpSIer3/Wudx3xvXRo/sYbb6x8fuWVV8bBgweP+E5WCy6++OJYsmRJKSIuySpN6RBoVoGf/OQn4/1urA6PPvrotMsuvfTSsa95JUBgagFj5tQus1qaV8Czcs2aNe2j59ZnVeCJX/7kJz9ZOaX0s5/9LH76059O/Cg+8pGPxN133x1pZ/qDH/wgTjjhhMM+z/JNqsfq1avbI6K6CC7LQkmLQE4C27Ztq+R80UUXjZfgd7/73RHLpvre+ApmCBCYKGDMnKjRTPPd3d2bvvWtb00+8jyn91/72tfSVZbliy66aHz9DRs2VJb19vaWX3vttfHltZy566670i3qDzTTdlBWApMEMuki73nPeyr97/777x9P74Ybbqgsu++++8aX3XjjjZVl3/3ud8eX1WLGKa1JW9nbphMwZjbdJnu9wF1dXS8//fTTmezbDh48WD7zzDMrO87vf//75S996UuV+bPOOqu8c+fOw/J4/vnnyx/60IfK5513XnnBggXlt771rYd9Xs2bp556qpzq9Xotj5hLt6LdERE3H/GJBQQaQ6CaLjC+7qmnnlrpg3/961/Hl61YsaKybPv27ePLzjjjjMqy5557rlzLvjmDgOcdEXF/RCxtjM2gFAQOF8hrzPze975XTj9gUp/u7Owsn3vuueWvf/3r5UOHDo3347nOzGDMPByhSd+d2N7ePpQClaym9Esy7dQWL15cbmlpKZ9++unll1566Yjk06/LtOHWrl1b2XBZBjypPieccMJQRHRN2i5jgU56QOFwRNw76XNvCTSKwBF9ZrYL/v73v1f64tKlS8dXTUdZU79805veNL5s7969lWUnnnhiOf0hby375lECnhTo9EXEPyPiQES8fg6uUbaIchCIyG3MXLlyZfnaa68t33PPPeWf//zn5XT2pK2trfyJT3xivC/PdeYoY+a82uaXnXvuua/OFWm69c4+++zKjnbJkiXlP/3pT1N+bWJUetNNN2V6hCdleM4557waEWNXYE4MdPaP7nRTGQU886o5z6vKTNlvZrPwxz/+caUfXnXVVeOr/eIXv6gs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AQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEjkOB/wfPd4qiJ7X5RwAAAABJRU5ErkJggg==)

The factor gives a score for every possible combination a variable may take on.

Here we define the two variables with different dimensions.

$$
x_1 =
\begin{pmatrix}
a \\
b \\
c \\
\end{pmatrix}
$$
and 
$$
x_2 =
\begin{pmatrix}
u \\
v \\
\end{pmatrix}
$$

The factor must be then:
$$
\psi_1 =
\begin{pmatrix}
s_{au} & s_{av} \\
s_{bu} & s_{bv} \\
s_{cu} & s_{cv} \\
\end{pmatrix}
$$

The rows relate to $$x_1$$ while the colums relate to $$x_2$$. $$s$$ results from a score function and is defined for every combination of these two variables. This can be thought: How likely it is that one variable may take on the other.

As we have here only one incomming message the factor-to-variable message is given my

$$\mu_{\psi_1 \to x_1}(x) = \sum_{\chi_f \setminus x}\psi_1(\chi_f) \mu_{x_2 \to \psi_1}(x)$$

We multiply the related variables and then sum over all variables that we don't need. This is:

$$
\mu_{\psi_1 \to x_1}(x) = 
\begin{pmatrix}
s_{au} u + s_{av} v\\
s_{bu} u + s_{bv} v\\
s_{cu} u + s_{cv} v\\
\end{pmatrix}
$$

Which is a matrix to vector multiplication for a binary factor.

#### Example 2:

Here we have now multiple messages towards the factor. You will see now that the factor might be a tensor of higher degree.

![image.png](data:image/png;base64,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)

We define now three variables with different dimensions.

$$
x_1 =
\begin{pmatrix}
a \\
b \\
c \\
\end{pmatrix}
$$
and 
$$
x_2 =
\begin{pmatrix}
m \\
n \\
\end{pmatrix}
$$
and
$$
x_3 =
\begin{pmatrix}
u \\
v \\
\end{pmatrix}
$$

The factor must be then:
$$
\psi_1 =
\begin{pmatrix}
\begin{pmatrix}
s_{amu} & s_{anu} \\
s_{bmu} & s_{bnu} \\
s_{cmu} & s_{cnu} \\
\end{pmatrix}
\begin{pmatrix}
s_{amv} & s_{anv} \\
s_{bmv} & s_{bnv} \\
s_{cmv} & s_{cnv} \\
\end{pmatrix}
\end{pmatrix}
$$

Again the rows relate to $$x_1$$, the colums relate to $$x_2$$ and now the third dimension rates to $$x_3$$. 

The factor-to-variable message is given with a addinanal message:

$$\mu_{\psi_1 \to x_1}(x) = \sum_{\chi_f \setminus x}\psi_1(\chi_f) \mu_{x_2 \to \psi_1}(x) \mu_{x_3 \to \psi_1}(x)$$

We multiply like before the related variables and then sum over all variables that we don't need. This is:

$$
\mu_{\psi_1 \to x_1}(x) = 
\begin{pmatrix}
s_{amu} m u + s_{anu} n u + s_{amv} m v + s_{anv} n v\\
s_{bmu} m u + s_{bnu} n u + s_{bmv} m v + s_{bnv} n v\\
s_{cmu} m u + s_{cnu} n u + s_{cmv} m v + s_{cnv} n v\\
\end{pmatrix}
$$


### Marginal

The marginal of a variable $$x$$ is given by

$$p(x) \propto \prod_{f \in ne(x)}\mu_{f \to x}(x)$$

This is a pointwise multiplication like above. One might normalize over the variable.

### Multiplying distributions implementation

In belief propagation we need to compute the product of distributions, such as $$p(h_2 \mid h_1)p(h_1)$$.

But only a multiplication of a multidimensional array by a 1D array and occasionally a scalar is needed. 

This is implemented by aliging the axis of the 1D array with its corresponding axis from the other distribution. Then the 1D array is tiled to be the size of $$p(h_2 \mid h_1)$$. This gives the joint distribution $$p(h_1, h_2)$$.


```python
def tile_to_shape_along_axis(arr, target_shape, target_axis):
    # get a list of all axes
    raw_axes = list(range(len(target_shape)))
    tile_dimensions = [target_shape[a] for a in raw_axes if a != target_axis]
    if len(arr.shape) == 0:
        # If given a scalar, also tile it in the target dimension (so it's a bunch of 1s)
        tile_dimensions += [target_shape[target_axis]]
    elif len(arr.shape) == 1:
        # If given an array, it should be the same shape as the target axis
        assert arr.shape[0] == target_shape[target_axis]
        tile_dimensions += [1]
    else:
        raise NotImplementedError()
    tiled = np.tile(arr, tile_dimensions)

    # Tiling only adds prefix axes, so rotate this one back into place
    shifted_axes = raw_axes[:target_axis] + [raw_axes[-1]] + raw_axes[target_axis:-1]
    transposed = np.transpose(tiled, shifted_axes)

    # Double-check this code tiled it to the correct shape
    assert transposed.shape == target_shape
    return transposed

def tile_to_other_dist_along_axis_name(tiling_labeled_array, target_array):
    assert len(tiling_labeled_array.axes_labels) == 1
    target_axis_label = tiling_labeled_array.axes_labels[0]
    
    return LabeledArray(
        tile_to_shape_along_axis(
            tiling_labeled_array.array,
            target_array.array.shape,
            name_to_axis_mapping(target_array)[target_axis_label]
        ),
        axes_labels=target_array.axes_labels
    )
```


```python
p_v1_given_h1_test = LabeledArray(np.array([[0.4, 0.8, 0.9], [0.6, 0.2, 0.1]]), ['v1', 'h1'])

p_h1_test = LabeledArray(np.array([0.6, 0.3, 0.1]), ['h1'])

tiled_p_h1_test = tile_to_other_dist_along_axis_name(p_h1_test, p_v1_given_h1_test)

# Check that the product is a joint distribution (p(v1, h1))
assert np.isclose(np.sum(p_v1_given_h1_test.array * tiled_p_h1_test.array), 1.0)
```

# Implementation of Belief Propagation for Trees without Cycles


```python
class BeliefPropagation(object):
    def _variable_to_factor_messages(self, variable, factor):
        # Take the product over all incoming factors into this variable except the variable
        incoming_messages = [
            self.factor_to_variable_message(edge_to_factor, variable)
            for edge_to_factor in variable.edges
            if edge_to_factor.neighbor.name != factor.name
        ]

        # If there are no incoming messages, this is 1
        return np.prod(incoming_messages, axis=0)
    
    def _factor_to_variable_messages(self, factor, variable):
        # Compute the product
        factor_dist = np.copy(factor.data.array)
        for edge_to_variable in factor.edges:
            if edge_to_variable.neighbor.name == variable.name:
                continue
            incoming_message = self.variable_to_factor_messages(edge_to_variable, factor)
            factor_dist *= tile_to_other_dist_along_axis_name(
                LabeledArray(incoming_message, [edge_to_variable.neighbor.name]),
                factor.data
            ).array
        # Sum over the axes that aren't `variable`
        other_axes = other_axes_from_labeled_axes(factor.data, variable.name)
        return np.squeeze(np.sum(factor_dist, axis=other_axes))
    
    def marginal(self, variable):
        # p(variable) is proportional to the product of incoming messages to variable.
        unnorm_p = np.prod([
            self.factor_to_variable_message(edge_to_factor, variable)
            for edge_to_factor in variable.edges
        ], axis=0)

        # At this point, we can normalize this distribution
        return unnorm_p/np.sum(unnorm_p)
    
    def variable_to_factor_messages(self, edge_to_variable, factor):
        if edge_to_variable.message is None:
            edge_to_variable.message = self._variable_to_factor_messages(edge_to_variable.neighbor, factor)
        return edge_to_variable.message
        
    def factor_to_variable_message(self, edge_to_factor, variable):
        if edge_to_factor.message is None:
            edge_to_factor.message = self._factor_to_variable_messages(edge_to_factor.neighbor, variable)
        return edge_to_factor.message
```


```python
BeliefPropagation().marginal(v2)
```




    array([0.23, 0.77])



Right Value: array([0.23, 0.77])


```python
BeliefPropagation().marginal(v1)
```




    array([0.2, 0.8])



Right Value: array([0.2, 0.8])

# Iterative Loopy Belief Propagation

The message passing is done in the same way as defined above.

The variable-to-factor message is given by:

$$\mu_{x \to f}(x) = \prod_{g \in \{ne(x) \setminus f\}} \mu_{g \to x}(x)$$

where $$ne(x)$$ are the neighbors of $$x$$.

The variable-to-factor message is given by 

$$\mu_{f \to x}(x) = \sum_{\chi_f \setminus x}\phi_f(\chi_f) \prod_{y \in \{ne(f) \setminus x \}} \mu_{y \to f}(y)$$

These operations are executed for all variable nodes in parallel while fixing $$\mu_{g \to x}(x)$$ and updating the messages. The messages for the first iteration must be intialized with a prior.  It can be shown that this coverges for the most belief netwworks.


```python
class LoopyBeliefPropagation(object):
    def loop(self, n_iterations, belief_network):
        variables = [
            node
            for node in belief_network
            if isinstance(node, Variable) == True
        ]
        for i in range(n_iterations):
            for variable in variables:
                for edge_to_factor in variable.edges:
                    self.factor_to_variable_message(edge_to_factor, variable)

    def _variable_to_factor_messages(self, variable, factor):
        # Take the product over all incoming factors into this variable except the variable
        incoming_messages = [
            # self.factor_to_variable_message(edge_to_factor, variable)
            # use instead the fixed point
            edge_to_factor.message
            for edge_to_factor in variable.edges
            if edge_to_factor.neighbor.name != factor.name
        ]

        # If there are no incoming messages, this is 1
        return np.prod(incoming_messages, axis=0)
    
    def _factor_to_variable_messages(self, factor, variable):
        # Compute the product
        factor_dist = np.copy(factor.data.array)
        for edge_to_variable in factor.edges:
            if edge_to_variable.neighbor.name == variable.name:
                continue
            incoming_message = self.variable_to_factor_messages(edge_to_variable, factor)
            factor_dist *= tile_to_other_dist_along_axis_name(
                LabeledArray(incoming_message, [edge_to_variable.neighbor.name]),
                factor.data
            ).array
        # Sum over the axes that aren't `variable`
        other_axes = other_axes_from_labeled_axes(factor.data, variable.name)
        return np.squeeze(np.sum(factor_dist, axis=other_axes))
    
    def marginal(self, variable):
        # p(variable) is proportional to the product of incoming messages to variable.
        unnorm_p = np.prod([
            #self.factor_to_variable_message(edge_to_factor, variable)
            edge_to_factor.message
            for edge_to_factor in variable.edges
        ], axis=0)

        # At this point, we can normalize this distribution
        return unnorm_p/np.sum(unnorm_p)
    
    def variable_to_factor_messages(self, edge_to_variable, factor):
        edge_to_variable.message = self._variable_to_factor_messages(edge_to_variable.neighbor, factor)
        return edge_to_variable.message
        
    def factor_to_variable_message(self, edge_to_factor, variable):
        edge_to_factor.message = self._factor_to_variable_messages(edge_to_factor.neighbor, variable)
        return edge_to_factor.message
```

## Test Loopy Belief Propagation with One Iteration


```python
for node in belief_network:
  node.init_messages([100000, 1]); # initialze with a strange prior

LoopyBeliefPropagation().loop(1, belief_network);

print(LoopyBeliefPropagation().marginal(v1))
print(LoopyBeliefPropagation().marginal(v2))


```

    [0.29230414 0.70769586]
    [0.23 0.77]


Correct Values: 
```
array([0.2, 0.8])
array([0.23, 0.77])
```

## Test Loopy Belief Propagation with Two Iterations 

coverges already.


```python
for node in belief_network:
  node.init_messages([100000, 1]); # initialze with a strange prior

LoopyBeliefPropagation().loop(2, belief_network);

print(LoopyBeliefPropagation().marginal(v1))
print(LoopyBeliefPropagation().marginal(v2))


```

    [0.2 0.8]
    [0.23 0.77]


## What's next

Loopy Belief Propagation doesn't make much sense so far as the graph doesn't contain loops. We could just show that it converges to the same result as the non-loopy version. A better application of Loopy Belief Propagation is shown and explained step by step [here](https://mayio.github.io/graph/2022/09/23/Noise-Reduction-Loopy-Belief-Propagation.html) on my blog


## See Also
 - Some slides for the [topic](http://www.cs.cmu.edu/~mgormley/bp-tutorial/)
 - A youtube video on the [topic](https://www.youtube.com/watch?v=B_ahqu50VjY)
 - Python library [pgmpy](https://github.com/pgmpy/pgmpy) does probabilistic graphical models and has nice code!
 - Simple Noise Reduction with [Loopy Belief Propagation](https://mayio.github.io/graph/2022/09/23/Noise-Reduction-Loopy-Belief-Propagation.html)
